<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #FF4D4D;
        }
    </style>

    
    
    
    
    
    

    
    <title>å°¾é€’å½’-Java-Kotlin</title>
    <meta name="description" content="keep curious ğŸ˜¼">
    <meta name="keywords" content='blog, chinalhr, lhr, å°¾é€’å½’'>

    <meta property="og:url" content="https://chinalhr.github.io/post/tail-recursion/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="å°¾é€’å½’-Java-Kotlin">
    <meta property="og:description" content="keep curious ğŸ˜¼">
    <meta property="og:image" content="https://user-images.githubusercontent.com/19829495/188320707-5b468cc9-bea4-486c-b591-57ff8324e41c.jpg">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="å°¾é€’å½’-Java-Kotlin">
    <meta name="twitter:description" content="keep curious ğŸ˜¼">
    <meta property="twitter:domain" content="https://chinalhr.github.io/post/tail-recursion/">
    <meta property="twitter:url" content="https://chinalhr.github.io/post/tail-recursion/">
    <meta name="twitter:image" content="https://user-images.githubusercontent.com/19829495/188320707-5b468cc9-bea4-486c-b591-57ff8324e41c.jpg">

    
    <link rel="canonical" href="https://chinalhr.github.io/post/tail-recursion/" />

    <link rel="stylesheet" type="text/css" href="https://chinalhr.github.io//css/normalize.min.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" type="text/css" href="https://chinalhr.github.io//css/main.css">
    <link disabled id="dark-theme" rel="stylesheet" href="https://chinalhr.github.io//css/dark.css">

    <script src="https://chinalhr.github.io//js/svg-injector.min.js"></script>
    <script src="https://chinalhr.github.io//js/feather-icons.min.js"></script>
    <script src="https://chinalhr.github.io//js/main.js"></script>

    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JLJBQBW5WM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-JLJBQBW5WM');
</script>
  
    
    
    
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">

        
        <div class="avatar">
            <a href="https://chinalhr.github.io/">
                <img src="https://user-images.githubusercontent.com/19829495/188320707-5b468cc9-bea4-486c-b591-57ff8324e41c.jpg" alt="avatar" />
            </a>
        </div>
        

        <div class="nav-title">
            <a class="nav-brand" href="https://chinalhr.github.io/">LHR</a>
        </div>

        <div class="nav-links">
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/"><span data-feather='home'></span> Home </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/post/"><span data-feather='book'></span> Posts </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/tags/"><span data-feather='tag'></span> Tags </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/projects/"><span data-feather='code'></span> Projects </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/about/"><span data-feather='user'></span> About </a>
            </div>
            
            <div class="nav-link">
                <a href="https://github.com/chinalhr"><span data-feather='github'></span>  </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/index.xml"><span data-feather='rss'></span>  </a>
            </div>
            

            <span class="nav-icons-divider"></span>
            <div class="nav-link dark-theme-toggle">
                <span id="dark-theme-toggle-screen-reader-target" class="sr-only"></span>
                <a>
                    <span id="theme-toggle-icon" data-feather="moon"></span>
                </a>
            </div>

            <div class="nav-link" id="hamburger-menu-toggle">
                <span id="hamburger-menu-toggle-screen-reader-target" class="sr-only">menu</span>
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/"><span data-feather='home'></span> Home </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/post/"><span data-feather='book'></span> Posts </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/tags/"><span data-feather='tag'></span> Tags </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/projects/"><span data-feather='code'></span> Projects </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/about/"><span data-feather='user'></span> About </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://github.com/chinalhr"><span data-feather='github'></span>  </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/index.xml"><span data-feather='rss'></span>  </a>
                </li>
                
                <li class="nav-item dark-theme-toggle">
                    <span id="dark-theme-toggle-screen-reader-target" class="sr-only">theme</span>
                    <a>
                        <span id="theme-toggle-icon" data-feather="moon"></span>
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</header>
<main id="content">
    <div class="post container">
    <div class="post-header-section">
        <h1>å°¾é€’å½’-Java-Kotlin</h1>
        <small role="doc-subtitle"></small>
        <p class="post-date">
            August 4, 2019
        </p>

        <ul class="post-tags">
        
            <li class="post-tag"><a href="https://chinalhr.github.io/tags/%E5%B0%BE%E9%80%92%E5%BD%92">å°¾é€’å½’</a></li>
        
        </ul>
    </div>

    <div class="post-content">
        <p>
            <blockquote>
<p>å°¾é€’å½’ä¸é€’å½’çš„å¯¹æ¯”ï¼Œä»¥åŠåœ¨Javaä¸Kotlinä¸­å¦‚ä½•è¿ç”¨</p>
</blockquote>
<h3 id="å…³äºå°¾é€’å½’">å…³äºå°¾é€’å½’</h3>
<ul>
<li>å°¾é€’å½’</li>
</ul>
<p>å°¾é€’å½’ï¼Œæ¯”çº¿æ€§é€’å½’å¤šä¸€ä¸ªå‚æ•°(è¿™ä¸ªå‚æ•°æ˜¯ä¸Šä¸€æ¬¡è°ƒç”¨å‡½æ•°å¾—åˆ°çš„ç»“æœ)ã€‚å…³é”®ç‚¹åœ¨äºï¼Œå°¾é€’å½’æ¯æ¬¡è°ƒç”¨éƒ½åœ¨æ”¶é›†ç»“æœï¼Œé¿å…äº†çº¿æ€§é€’å½’ä¸æ”¶é›†ç»“æœåªèƒ½ä¾æ¬¡å±•å¼€æ¶ˆè€—å†…å­˜çš„åå¤„ã€‚</p>
<p>çº¿æ€§é€’å½’åˆ›å»ºæ ˆå†…å­˜ç´¯ç§¯è€Œåè®¡ç®—æ”¶ç¼©ï¼Œå°¾é€’å½’åªä¼šå ç”¨æ’é‡çš„å†…å­˜(ç±»ä¼¼è¿­ä»£)ã€‚</p>
<ul>
<li>å°¾é€’å½’ä¼˜åŒ–</li>
</ul>
<p>å°¾é€’å½’ä¼˜åŒ–ä¸»è¦æ˜¯å¯¹æ ˆå†…å­˜ç©ºé—´çš„ä¼˜åŒ–,ä»O(n)åˆ°O(1)ã€‚å¯¹äºæ—¶é—´çš„ä¼˜åŒ–æ˜¯ç”±äºå¯¹ç©ºé—´çš„ä¼˜åŒ–å¯¼è‡´å†…å­˜åˆ†é…çš„å·¥ä½œå‡å°‘æ‰€äº§ç”Ÿçš„, æ˜¯ä¸€ä¸ªå¸¸æ•°çº§åˆ«çš„ä¼˜åŒ–ã€‚</p>
<ul>
<li>å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„é€’å½’ä¸è¿­ä»£</li>
</ul>
<p>åœ¨ä¸€äº›å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€(ä¾‹å¦‚Scala)ä¸­æ˜¯é¼“åŠ±ä½¿ç”¨é€’å½’ï¼Œè€Œä¸æ˜¯å¾ªç¯æ¥è§£å†³é—®é¢˜ã€‚è¿™æ˜¯å› ä¸ºå¾ªç¯ä¼šå¼•å…¥ä¸­é—´å˜é‡,è€Œå‡½æ•°èŒƒå¼å¼ºè°ƒçš„æ˜¯æ— å‰¯ä½œç”¨ï¼Œå¼ºè°ƒå‡½æ•°è®¡ç®—çš„çº¯ç²¹æ€§ï¼Œæ¯ä¸ªå‡½æ•°çš„æ‰§è¡Œéƒ½æ˜¯æ²¡æœ‰å‰¯ä½œç”¨çš„ï¼Œ
å‡½æ•°æ‰€æœ‰åŠŸèƒ½å°±æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å€¼ï¼Œæ²¡æœ‰å…¶ä»–è¡Œä¸ºï¼Œå°¤å…¶æ˜¯ä¸å¾—ä¿®æ”¹å¤–éƒ¨å˜é‡çš„å€¼ã€‚</p>
<h3 id="å°¾é€’å½’ç¤ºä¾‹">å°¾é€’å½’ç¤ºä¾‹</h3>
<ul>
<li>é€’å½’å®ç°é˜¶ä¹˜</li>
</ul>
<pre><code>public static int factorialRecursion(final int number) {
    if (number == 1) return number;
        else return number * factorialRecursion(number - 1);
}

å½“è°ƒç”¨factorialRecursion(5)æ—¶ æ ˆçš„æƒ…å†µ:

factorialRecursion(5)
5 * factorialRecursion(4)
5 * (4 * factorialRecursion(3))
5 * (4 * (3 * factorialRecursion(2)))
5 * (4 * (3 * (2 * factorialRecursion(1))))
5 * (4 * (3 * (2 * 1)))
5 * (4 * (3 * 2))
5 * (4 * 6)
5 * 24
120

è¿™é‡Œå°±æ˜¯å…¸å‹çš„çº¿æ€§é€’å½’åˆ›å»ºæ ˆå†…å­˜ç´¯ç§¯è€Œåè®¡ç®—æ”¶ç¼©ï¼Œä»å·¦åˆ°å³ï¼Œè¾¾åˆ°é¡¶å³°ï¼Œå†ä»å³åˆ°å·¦æ”¶ç¼©ã€‚ä½¿ç”¨è¿­ä»£åªå æ®å¸¸é‡æ ˆï¼Œä½¿ç”¨æ›´æ–°æ ˆè€Œé
æ‰©å±•æ ˆè¿›è¡Œè®¡ç®—ï¼Œå› æ­¤è¿­ä»£ç›¸æ¯”çº¿æ€§é€’å½’ä½¿ç”¨çš„å†…å­˜æ›´å°‘ã€‚

ä¸ºä»€ä¹ˆä¼šæ‰©å±•ï¼šå› ä¸ºåœ¨æ²¡æœ‰é€’å½’åˆ°åº•ä¹‹å‰ï¼Œç¨‹åºçš„ä¸­é—´å˜é‡ä¼šä¸€ç›´ä¿å­˜ç€ï¼Œå› æ­¤æ¯ä¸€æ¬¡é€’å½’éƒ½éœ€è¦å¼€è¾Ÿä¸€ä¸ªæ–°çš„æ ˆç©ºé—´æ¥ä¿å­˜ä¸­é—´å˜é‡
</code></pre><ul>
<li>å°¾é€’å½’å®ç°é˜¶ä¹˜</li>
</ul>
<pre><code> public static int factorialTailRecursion(final int factorial, final int number) {
        if (number == 1) return factorial;
        else return factorialTailRecursion(factorial * number, number - 1);
}

å½“è°ƒç”¨factorialTailRecursion(1,5)æ—¶:

factorialTailRecursion(1, 5)
factorialTailRecursion(5, 4)
factorialTailRecursion(20, 3)
factorialTailRecursion(60, 2)
factorialTailRecursion(120, 1)
120

åˆ†æä¸Šé¢é€’å½’å‡½æ•°æ ˆç´¯ç§¯çš„åŸå› å°±æ˜¯åœ¨æ¯æ¬¡returnçš„æ—¶å€™éƒ½ä¼šé™„å¸¦ä¸€ä¸ªå˜é‡ï¼Œå› æ­¤åªéœ€è¦åœ¨returnçš„æ—¶å€™ä¸é™„å¸¦è¿™ä¸ªå˜é‡å³å¯ã€‚å°¾é€’å½’ä½¿ç”¨ä¸€ä¸ªå‚æ•°æ¥ä¿å­˜ä¸Šä¸€è½®é€’å½’çš„ç»“æœï¼ŒæŠŠå˜åŒ–çš„å‚æ•°ä¼ é€’ç»™é€’å½’å‡½æ•°çš„å˜é‡äº†ã€‚

å°¾é€’å½’é€šè¿‡æ¯è½®é€’å½’ç»“æŸååˆ·æ–°å½“å‰çš„æ ˆç©ºé—´ï¼Œå¤ç”¨äº†æ ˆï¼Œå…‹æœäº†çº¿æ€§é€’å½’æ ˆå†…å­˜ç´¯ç§¯è€Œåè®¡ç®—æ”¶ç¼©ï¼Œå­˜åœ¨æ ˆæº¢å‡ºé£é™©ã€‚

æ€»ç»“å°¾é€’å½’ï¼šreturnåé¢ä¸é™„å¸¦ä»»ä½•å˜é‡çš„é€’å½’å†™æ³•ï¼Œé€’å½’å‘ç”Ÿåœ¨å‡½æ•°æœ€å°¾éƒ¨,æˆ‘ä»¬ç§°ä¹‹ä¸º'å°¾é€’å½’'ã€‚
</code></pre><h3 id="å°¾é€’å½’ä¼˜åŒ–-java">å°¾é€’å½’ä¼˜åŒ–-Java</h3>
<p>Tail-Recursion ä¾èµ–äºç¼–è¯‘å™¨å¯¹å°¾é€’å½’å†™æ³•çš„ä¼˜åŒ–ï¼ŒJavacå¯¹Tail-Recursionå¹¶æ²¡æœ‰åšç‰¹å®šçš„ä¼˜åŒ–ï¼Œä½¿ç”¨å°¾é€’å½’çš„å†™æ³•ï¼Œè¯¥æ ˆæº¢å‡ºè¿˜æ˜¯æ ˆæº¢å‡ºã€‚</p>
<p>Javacä¸ºä»€ä¹ˆæ²¡æœ‰Tail-Recursionä¼˜åŒ–ï¼Œå‚è€ƒä¸‹é¢çš„é“¾æ¥,å¯ä»¥å¾—çŸ¥åŸå› :</p>
<p>å› ä¸ºåœ¨JDKè®¸å¤šç±»ä¸­ï¼Œæœ‰è®¸å¤šå®‰å…¨æ•æ„Ÿæ–¹æ³•ä¾èµ–äºè®¡ç®—JDKåº“ä»£ç å’Œè°ƒç”¨ä»£ç ä¹‹é—´çš„å †æ ˆå¸§æ¥ç¡®å®šè°åœ¨è°ƒç”¨å®ƒä»¬ã€‚tail-recursionä¼˜åŒ–ä¼šæ”¹å˜å †æ ˆä¸Šå¸§æ•°ï¼Œä¼šç ´åå®ƒå¹¶å¯¼è‡´è®¡ç®—é”™è¯¯ã€‚å› æ­¤JDKå¼€å‘äººå‘˜å·²ç»å–ä»£äº†è¿™ç§æœºåˆ¶ã€‚</p>
<p><a href="https://softwareengineering.stackexchange.com/questions/272061/why-doesnt-java-have-optimization-for-tail-recursion-at-all">https://softwareengineering.stackexchange.com/questions/272061/why-doesnt-java-have-optimization-for-tail-recursion-at-all</a></p>
<ul>
<li>ä½¿ç”¨Lambdaä¼˜åŒ–å°¾é€’å½’</li>
</ul>
<p>è®¾è®¡ä¸€ä¸ªå‡½æ•°æ¥å£ä»£æ›¿é€’å½’ä¸­çš„æ ˆå¸§ï¼Œåˆ©ç”¨Streamå°†é€’å½’è½¬æ¢ä¸ºè¿­ä»£ï¼Œ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * @Author : lhr
</span><span style="color:#75715e"> * @Date : 11:15 2019/8/3
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * å°¾é€’å½’å‡½æ•°å¼æ¥å£
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@FunctionalInterface</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">TailRecursion</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * ç”¨äºé€’å½’æ ˆå¸§ä¹‹é—´çš„è¿æ¥,æƒ°æ€§æ±‚å€¼
</span><span style="color:#75715e">     * @return ä¸‹ä¸€ä¸ªé€’å½’æ ˆå¸§
</span><span style="color:#75715e">     */</span>
    TailRecursion<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">apply</span><span style="color:#f92672">();</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * åˆ¤æ–­å½“å‰é€’å½’æ˜¯å¦ç»“æŸ
</span><span style="color:#75715e">     * @return é»˜è®¤ä¸ºfalse,å› ä¸ºæ­£å¸¸çš„é€’å½’è¿‡ç¨‹ä¸­éƒ½è¿˜æœªç»“æŸ
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">isFinished</span><span style="color:#f92672">(){</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * è·å¾—é€’å½’ç»“æœ,åªæœ‰åœ¨é€’å½’ç»“æŸæ‰èƒ½è°ƒç”¨,è¿™é‡Œé»˜è®¤ç»™å‡ºå¼‚å¸¸,é€šè¿‡å·¥å…·ç±»çš„é‡å†™æ¥è·å¾—å€¼
</span><span style="color:#75715e">     * @return é€’å½’æœ€ç»ˆç»“æœ
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">default</span> T <span style="color:#a6e22e">getResult</span><span style="color:#f92672">()</span>  <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;é€’å½’è¿˜æ²¡æœ‰ç»“æŸ,è°ƒç”¨è·å¾—ç»“æœå¼‚å¸¸!&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * åŠæ—©æ±‚å€¼,æ‰§è¡Œè€…ä¸€ç³»åˆ—çš„é€’å½’,å› ä¸ºæ ˆå¸§åªæœ‰ä¸€ä¸ª,æ‰€ä»¥ä½¿ç”¨findFirstè·å¾—æœ€ç»ˆçš„æ ˆå¸§,æ¥ç€è°ƒç”¨getResultæ–¹æ³•è·å¾—æœ€ç»ˆé€’å½’å€¼
</span><span style="color:#75715e">     * @return åŠæ—©æ±‚å€¼,è·å¾—æœ€ç»ˆé€’å½’ç»“æœ
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">default</span> T <span style="color:#a6e22e">invoke</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> Stream<span style="color:#f92672">.</span><span style="color:#a6e22e">iterate</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">,</span> TailRecursion<span style="color:#f92672">::</span>apply<span style="color:#f92672">)</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">filter</span><span style="color:#f92672">(</span>TailRecursion<span style="color:#f92672">::</span>isFinished<span style="color:#f92672">)</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">findFirst</span><span style="color:#f92672">()</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">()</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">getResult</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>è®¾è®¡ä¸€ä¸ªå¯¹å¤–ç»Ÿä¸€çš„å°¾é€’å½’åŒ…è£…ç±»ï¼Œç›®çš„æ˜¯è¾¾åˆ°å¯ä»¥å¤ç”¨çš„æ•ˆæœï¼ŒåŒ…è£…é€’å½’æ–¹æ³• 1æ€æ ·è°ƒç”¨ä¸‹æ¬¡é€’å½’,2é€’å½’çš„ç»ˆæ­¢æ¡ä»¶</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * @Author : lhr
</span><span style="color:#75715e"> * @Date : 11:59 2019/8/3
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * ä½¿ç”¨å°¾é€’å½’çš„ç±»,ç›®çš„æ˜¯å¯¹å¤–ç»Ÿä¸€æ–¹æ³•
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * è°ƒç”¨ä¸‹æ¬¡é€’å½’/ç»“æŸæœ¬è½®é€’å½’
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TailInvoke</span> <span style="color:#f92672">{</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * ç»Ÿä¸€ç»“æ„çš„æ–¹æ³•ï¼Œè·å–å½“å‰é€’å½’çš„ä¸‹ä¸€ä¸ªé€’å½’
</span><span style="color:#75715e">     * @param nextFrame
</span><span style="color:#75715e">     * @param &lt;T&gt;
</span><span style="color:#75715e">     * @return
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> TailRecursion<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">call</span><span style="color:#f92672">(</span><span style="color:#66d9ef">final</span> TailRecursion<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> nextFrame<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> nextFrame<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * ç»“æŸå½“å‰é€’å½’ï¼Œé‡å†™å¯¹åº”çš„é»˜è®¤æ–¹æ³•çš„å€¼,å®ŒæˆçŠ¶æ€æ”¹ä¸ºtrue,è®¾ç½®æœ€ç»ˆè¿”å›ç»“æœ,è®¾ç½®éæ³•é€’å½’è°ƒç”¨
</span><span style="color:#75715e">     *
</span><span style="color:#75715e">     * @param value æœ€ç»ˆé€’å½’å€¼
</span><span style="color:#75715e">     * @param &lt;T&gt;   T
</span><span style="color:#75715e">     * @return ä¸€ä¸ªisFinishedçŠ¶æ€trueçš„å°¾é€’å½’, å¤–éƒ¨é€šè¿‡è°ƒç”¨æ¥å£çš„invokeæ–¹æ³•åŠæ—©æ±‚å€¼, å¯åŠ¨é€’å½’æ±‚å€¼ã€‚
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> TailRecursion<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">done</span><span style="color:#f92672">(</span>T value<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> TailRecursion<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> TailRecursion<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">apply</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;é€’å½’å·²ç»ç»“æŸ,éæ³•è°ƒç”¨applyæ–¹æ³•&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>

            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">isFinished</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>

            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> T <span style="color:#a6e22e">getResult</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> value<span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">};</span>
    <span style="color:#f92672">}</span>

<span style="color:#f92672">}</span>
</code></pre></div><p>lamdbaä¼˜åŒ–å°¾é€’å½’ é˜¶ä¹˜è®¡ç®—ç¤ºä¾‹</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">   <span style="color:#75715e">/**
</span><span style="color:#75715e">     * é˜¶ä¹˜è®¡ç®— -- ä½¿ç”¨å°¾é€’å½’æ¥å£å®Œæˆ
</span><span style="color:#75715e">     *
</span><span style="color:#75715e">     * @param factorial å½“å‰é€’å½’æ ˆçš„ç»“æœå€¼
</span><span style="color:#75715e">     * @param number    ä¸‹ä¸€ä¸ªé€’å½’éœ€è¦è®¡ç®—çš„å€¼
</span><span style="color:#75715e">     * @return å°¾é€’å½’æ¥å£, è°ƒç”¨invokeå¯åŠ¨åŠæ—©æ±‚å€¼è·å¾—ç»“æœ
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> TailRecursion<span style="color:#f92672">&lt;</span>Long<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">factorialTailRecursion</span><span style="color:#f92672">(</span><span style="color:#66d9ef">final</span> <span style="color:#66d9ef">long</span> factorial<span style="color:#f92672">,</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> number<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>number <span style="color:#f92672">==</span> 1<span style="color:#f92672">)</span>
            <span style="color:#66d9ef">return</span> TailInvoke<span style="color:#f92672">.</span><span style="color:#a6e22e">done</span><span style="color:#f92672">(</span>factorial<span style="color:#f92672">);</span>
        <span style="color:#66d9ef">else</span>
            <span style="color:#66d9ef">return</span> TailInvoke<span style="color:#f92672">.</span><span style="color:#a6e22e">call</span><span style="color:#f92672">(()</span> <span style="color:#f92672">-&gt;</span> factorialTailRecursion<span style="color:#f92672">(</span>factorial <span style="color:#f92672">+</span> number<span style="color:#f92672">,</span> number <span style="color:#f92672">-</span> 1<span style="color:#f92672">));</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">//è°ƒç”¨Invokeå¯åŠ¨è¿­ä»£å¹¶è·å–ç»“æœ
</span><span style="color:#75715e"></span>        factorialTailRecursion<span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> 10000000<span style="color:#f92672">).</span><span style="color:#a6e22e">invoke</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
</code></pre></div><h3 id="å°¾é€’å½’ä¼˜åŒ–-kotlin">å°¾é€’å½’ä¼˜åŒ–-Kotlin</h3>
<ul>
<li>tailrecå…³é”®å­—</li>
</ul>
<p>Kotlin æ”¯æŒå°¾é€’å½’ï¼Œè¿™å…è®¸ä¸€äº›é€šå¸¸ç”¨å¾ªç¯å†™çš„ç®—æ³•æ”¹ç”¨é€’å½’å‡½æ•°æ¥å†™ï¼Œè€Œæ— å †æ ˆæº¢å‡ºçš„é£é™©ã€‚ å½“ä¸€ä¸ªå‡½æ•°ç”¨ tailrec ä¿®é¥°ç¬¦æ ‡è®°å¹¶æ»¡è¶³æ‰€éœ€çš„å½¢å¼æ—¶ï¼Œç¼–è¯‘å™¨ä¼šä¼˜åŒ–è¯¥é€’å½’ï¼Œç•™ä¸‹ä¸€ä¸ªå¿«é€Ÿè€Œé«˜æ•ˆçš„åŸºäºå¾ªç¯çš„ç‰ˆæœ¬ã€‚</p>
<ul>
<li>å°¾é€’å½’å®ç°é˜¶ä¹˜(Kotlinç‰ˆæœ¬)</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">tailrec</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">factorialTailRecursion</span>(factorial: Int, number: Int): Int {
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">if</span> (number == <span style="color:#ae81ff">1</span>) factorial
    <span style="color:#66d9ef">else</span> factorialTailRecursion(factorial * number, number - <span style="color:#ae81ff">1</span>)
}
</code></pre></div><ul>
<li>æœ€ç»ˆä»£ç (ç»è¿‡Kotlinç¼–è¯‘å™¨ä¼˜åŒ–)</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">factorialTailRecursion</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> factorial<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> number<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#66d9ef">while</span><span style="color:#f92672">(</span>number <span style="color:#f92672">!=</span> 1<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
         <span style="color:#66d9ef">int</span> var10000 <span style="color:#f92672">=</span> factorial <span style="color:#f92672">*</span> number<span style="color:#f92672">;</span>
         <span style="color:#f92672">--</span>number<span style="color:#f92672">;</span>
         factorial <span style="color:#f92672">=</span> var10000<span style="color:#f92672">;</span>
      <span style="color:#f92672">}</span>

      <span style="color:#66d9ef">return</span> factorial<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="å‚è€ƒ">å‚è€ƒ</h3>
<p><a href="https://kotlintc.com/articles/4633">https://kotlintc.com/articles/4633</a></p>
<p><a href="https://www.cnblogs.com/invoker-/p/7723420.html">https://www.cnblogs.com/invoker-/p/7723420.html</a></p>
        </p>
    </div>
</div>

<aside class="post-toc">
    <nav id="toc">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#å…³äºå°¾é€’å½’">å…³äºå°¾é€’å½’</a></li>
            <li><a href="#å°¾é€’å½’ç¤ºä¾‹">å°¾é€’å½’ç¤ºä¾‹</a></li>
            <li><a href="#å°¾é€’å½’ä¼˜åŒ–-java">å°¾é€’å½’ä¼˜åŒ–-Java</a></li>
            <li><a href="#å°¾é€’å½’ä¼˜åŒ–-kotlin">å°¾é€’å½’ä¼˜åŒ–-Kotlin</a></li>
            <li><a href="#å‚è€ƒ">å‚è€ƒ</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
    </nav>
</aside>



    

        </main><footer class="footer">
    <span>&copy; 2023 hanrong.li</span>
    <span>
        Made with &#10084;&#65039; using <a target="_blank" href="https://github.com/526avijitgupta/gokarna">Gokarna</a>
    </span>
</footer>
</body>
</html>
