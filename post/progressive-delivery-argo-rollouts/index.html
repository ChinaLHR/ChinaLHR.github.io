<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #FF4D4D;
        }
    </style>

    
    
    
    
    
    

    
    <title>Kubernetesæ¸è¿›å¼äº¤ä»˜å®è·µï¼ŒåŸºäºArgo Rollouts</title>
    <meta name="description" content="keep curious ğŸ˜¼">
    <meta name="keywords" content='blog, chinalhr, lhr, progressive delivery, kubernetes, argo rollouts'>

    <meta property="og:url" content="https://chinalhr.github.io/post/progressive-delivery-argo-rollouts/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Kubernetesæ¸è¿›å¼äº¤ä»˜å®è·µï¼ŒåŸºäºArgo Rollouts">
    <meta property="og:description" content="keep curious ğŸ˜¼">
    <meta property="og:image" content="https://user-images.githubusercontent.com/19829495/188320707-5b468cc9-bea4-486c-b591-57ff8324e41c.jpg">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Kubernetesæ¸è¿›å¼äº¤ä»˜å®è·µï¼ŒåŸºäºArgo Rollouts">
    <meta name="twitter:description" content="keep curious ğŸ˜¼">
    <meta property="twitter:domain" content="https://chinalhr.github.io/post/progressive-delivery-argo-rollouts/">
    <meta property="twitter:url" content="https://chinalhr.github.io/post/progressive-delivery-argo-rollouts/">
    <meta name="twitter:image" content="https://user-images.githubusercontent.com/19829495/188320707-5b468cc9-bea4-486c-b591-57ff8324e41c.jpg">

    
    <link rel="canonical" href="https://chinalhr.github.io/post/progressive-delivery-argo-rollouts/" />

    <link rel="stylesheet" type="text/css" href="https://chinalhr.github.io//css/normalize.min.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" type="text/css" href="https://chinalhr.github.io//css/main.css">
    <link disabled id="dark-theme" rel="stylesheet" href="https://chinalhr.github.io//css/dark.css">

    <script src="https://chinalhr.github.io//js/svg-injector.min.js"></script>
    <script src="https://chinalhr.github.io//js/feather-icons.min.js"></script>
    <script src="https://chinalhr.github.io//js/main.js"></script>

    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JLJBQBW5WM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-JLJBQBW5WM');
</script>
  
    
    
    
    
    <script async src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    

    
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css">
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">

        
        <div class="avatar">
            <a href="https://chinalhr.github.io/">
                <img src="https://user-images.githubusercontent.com/19829495/188320707-5b468cc9-bea4-486c-b591-57ff8324e41c.jpg" alt="avatar" />
            </a>
        </div>
        

        <div class="nav-title">
            <a class="nav-brand" href="https://chinalhr.github.io/">LHR</a>
        </div>

        <div class="nav-links">
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/"><span data-feather='home'></span> Home </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/post/"><span data-feather='book'></span> Posts </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/tags/"><span data-feather='tag'></span> Tags </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/projects/"><span data-feather='code'></span> Projects </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/about/"><span data-feather='user'></span> About </a>
            </div>
            
            <div class="nav-link">
                <a href="https://github.com/chinalhr"><span data-feather='github'></span>  </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/index.xml"><span data-feather='rss'></span>  </a>
            </div>
            

            <span class="nav-icons-divider"></span>
            <div class="nav-link dark-theme-toggle">
                <span id="dark-theme-toggle-screen-reader-target" class="sr-only"></span>
                <a>
                    <span id="theme-toggle-icon" data-feather="moon"></span>
                </a>
            </div>

            <div class="nav-link" id="hamburger-menu-toggle">
                <span id="hamburger-menu-toggle-screen-reader-target" class="sr-only">menu</span>
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/"><span data-feather='home'></span> Home </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/post/"><span data-feather='book'></span> Posts </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/tags/"><span data-feather='tag'></span> Tags </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/projects/"><span data-feather='code'></span> Projects </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/about/"><span data-feather='user'></span> About </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://github.com/chinalhr"><span data-feather='github'></span>  </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/index.xml"><span data-feather='rss'></span>  </a>
                </li>
                
                <li class="nav-item dark-theme-toggle">
                    <span id="dark-theme-toggle-screen-reader-target" class="sr-only">theme</span>
                    <a>
                        <span id="theme-toggle-icon" data-feather="moon"></span>
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</header>
<main id="content">
    <div class="post container">
    <div class="post-header-section">
        <h1>Kubernetesæ¸è¿›å¼äº¤ä»˜å®è·µï¼ŒåŸºäºArgo Rollouts</h1>
        <small role="doc-subtitle"></small>
        <p class="post-date">
            September 29, 2022
        </p>

        <ul class="post-tags">
        
            <li class="post-tag"><a href="https://chinalhr.github.io/tags/progressive-delivery">progressive delivery</a></li>
        
            <li class="post-tag"><a href="https://chinalhr.github.io/tags/kubernetes">kubernetes</a></li>
        
            <li class="post-tag"><a href="https://chinalhr.github.io/tags/argo-rollouts">argo rollouts</a></li>
        
        </ul>
    </div>

    <div class="post-content">
        <p>
            <blockquote>
<p>åŸºäºArgo Rolloutsï¼ŒKubernetesçš„æ¸è¿›å¼äº¤ä»˜å®è·µ</p>
</blockquote>
<h2 id="å…³äºæ¸è¿›å¼äº¤ä»˜">å…³äºæ¸è¿›å¼äº¤ä»˜</h2>
<h3 id="ä»€ä¹ˆæ˜¯æ¸è¿›å¼äº¤ä»˜">ä»€ä¹ˆæ˜¯æ¸è¿›å¼äº¤ä»˜</h3>
<p>æ¸è¿›å¼äº¤ä»˜æ˜¯ä»¥å—æ§å’Œæ¸è¿›æ–¹å¼å‘å¸ƒ/æ›´æ–°çš„è¿‡ç¨‹ï¼Œé‡‡ç”¨æ¸è¿›çš„æ–¹å¼ä»è€Œé™ä½å‘å¸ƒé£é™©ï¼Œé€šå¸¸ç»“åˆè‡ªåŠ¨åŒ–å’Œåº¦é‡æŒ‡æ ‡åˆ†ææ¥é©±åŠ¨æ–°åº”ç”¨çš„è‡ªåŠ¨å‡çº§æˆ–è‡ªåŠ¨å›æ»šã€‚</p>
<p>æ¸è¿›å¼äº¤ä»˜å»ºç«‹åœ¨æŒç»­é›†æˆå’ŒæŒç»­äº¤ä»˜ (CI/CD) çš„æ ¸å¿ƒåŸåˆ™ä¹‹ä¸Šï¼Œé€šè¿‡åœ¨äº¤ä»˜é˜¶æ®µï¼Œé€šè¿‡å°†æ–°ç‰ˆæœ¬çš„æ›å…‰é™åˆ¶ç»™ä¸€éƒ¨åˆ†ç”¨æˆ·ï¼Œè§‚å¯Ÿå’Œåˆ†ææ­£ç¡®çš„è¡Œä¸ºï¼Œç„¶åé€æ¸å¢åŠ å¯¹æ›´å¹¿æ³›çš„å—ä¼—çš„æ›å…‰ï¼ŒåŒæ—¶ä¸æ–­éªŒè¯æ­£ç¡®æ€§æ¥å®ç°ã€‚æ¸è¿›å¼äº¤ä»˜æä¾›äº†å®‰å…¨æªæ–½å’Œæ§åˆ¶æ‰‹æ®µï¼Œä»¥é™ä½ä¸æ–­å°†æ–°ç‰ˆæœ¬æ¨é€åˆ°ç”Ÿäº§ç¯å¢ƒçš„é£é™©ã€‚</p>
<h3 id="æ¸è¿›å¼äº¤ä»˜éƒ¨ç½²ç­–ç•¥">æ¸è¿›å¼äº¤ä»˜éƒ¨ç½²ç­–ç•¥</h3>
<p>æ¸è¿›å¼äº¤ä»˜çš„éƒ¨ç½²ç­–ç•¥ä¸»è¦åŒºåˆ«äºå…¨é‡å‘å¸ƒä¸ä¸€æ¬¡æ€§å‘å¸ƒï¼ŒåŒ…å«ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li>å¢é‡çš„å‘å¸ƒè¿‡ç¨‹ï¼šå°†ä¸€æ¬¡å‘å¸ƒåˆ†æˆå¤šä¸ªæ‰¹æ¬¡ï¼Œå¹¶å¯¹æ¯ä¸ªæ‰¹æ¬¡çš„å‘å¸ƒã€åœæ­¢è¿›è¡Œæ§åˆ¶ã€‚</li>
<li>åº”ç”¨ä¸æµé‡åŒç»´åº¦çš„ç°åº¦ï¼šå¦‚Canary Releasesï¼ˆé‡‘ä¸é›€å‘å¸ƒï¼‰ã€A/B Testingã€Blue-green Deploymentsï¼ˆè“ç»¿éƒ¨ç½²ï¼‰ã€‚</li>
<li>éƒ¨ç½²é˜¶æ®µå¯éªŒè¯æ€§ï¼šå‘å¸ƒçš„æ¯ä¸ªæ‰¹æ¬¡ï¼Œå¯ä»¥éªŒè¯å‘å¸ƒçš„æ­£ç¡®æ€§ä»¥åŠæ˜¯å¦ç¬¦åˆå‘å¸ƒé¢„æœŸã€‚</li>
</ul>
<h4 id="blue-green-deploymentsè“ç»¿éƒ¨ç½²">Blue-green Deploymentsï¼ˆè“ç»¿éƒ¨ç½²ï¼‰</h4>
<p>ä½¿ç”¨Blue-green Deploymentsï¼Œåœ¨åªå­˜åœ¨æ—§ç‰ˆæœ¬åº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹,å¯¹æ–°ç‰ˆæœ¬åº”ç”¨ç¨‹åºè¿›è¡Œéƒ¨ç½²,æ­¤æ—¶ç”Ÿäº§ç¯å¢ƒå­˜åœ¨æ–°æ—§ä¸¤ä¸ªç‰ˆæœ¬çš„åº”ç”¨ç¨‹åº,æ­¤æœŸé—´ï¼Œåªæœ‰æ—§ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºä¼šæ”¶åˆ°ç”Ÿäº§æµé‡ï¼Œå…è®¸å¼€å‘äººå‘˜åœ¨å°†å®æ—¶æµé‡åˆ‡æ¢åˆ°æ–°ç‰ˆæœ¬ä¹‹å‰é’ˆå¯¹æ–°ç‰ˆæœ¬åº”ç”¨ç¨‹åºè¿›è¡Œæµ‹è¯•ä¸åº¦é‡æŒ‡æ ‡åˆ†æï¼Œå¹¶æ ¹æ®æµ‹è¯•ç»“æœå†³å®šæ˜¯å¦è¿›è¡Œç‰ˆæœ¬çš„åˆ‡æ¢ã€‚</p>
<ul>
<li>Phase 1</li>
</ul>
<div class="mermaid">
    
flowchart LR
    User --> Loadbalancer
    Loadbalancer --> |Network Traffic|Application-Version-1

</div>
<ul>
<li>Phase 2</li>
</ul>
<div class="mermaid">
    
flowchart LR
    User --> Loadbalancer
    Loadbalancer --> |Network Traffic|Application-Version-1 
    Loadbalancer -.- Application-Version-2

</div>
<ul>
<li>Phase 3</li>
</ul>
<div class="mermaid">
    
flowchart LR
    User --> Loadbalancer
    Loadbalancer -.- Application-Version-1 
    Loadbalancer --> |Network Traffic|Application-Version-2

</div>
<ul>
<li>Phase 4</li>
</ul>
<div class="mermaid">
    
flowchart LR
    User --> Loadbalancer 
    Loadbalancer --> |Network Traffic|Application-Version-2

</div>
<h4 id="canary-releasesé‡‘ä¸é›€å‘å¸ƒ">Canary Releasesï¼ˆé‡‘ä¸é›€å‘å¸ƒï¼‰</h4>
<p>ä½¿ç”¨Canary Releasesï¼Œåœ¨åªå­˜åœ¨æ—§ç‰ˆæœ¬åº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹,å¯¹æ–°ç‰ˆæœ¬åº”ç”¨ç¨‹åºè¿›è¡Œéƒ¨ç½²ï¼Œä¼šå°†ä¸€éƒ¨åˆ†æµé‡è·¯ç”±ç»™æ–°ç‰ˆæœ¬åº”ç”¨ç¨‹åºï¼ŒåŒæ—¶å°†å…¶ä½™æµé‡æä¾›ç»™æ—§ç‰ˆæœ¬åº”ç”¨ç¨‹åºï¼›å½“æ–°ç‰ˆæœ¬åº”ç”¨ç¨‹åºéªŒè¯æ— è¯¯åï¼Œåˆ™æ–°ç‰ˆæœ¬åº”ç”¨ç¨‹åºä»¥é€æ­¥å–ä»£æ—§ç‰ˆæœ¬ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒLoadBalancerå¯ä»¥ä¸ºCanary Releasesæä¾›æ›´å¤šçš„æµé‡è·¯ç”±ç­–ç•¥ã€‚</p>
<ul>
<li>Phase 1</li>
</ul>
<div class="mermaid">
    
flowchart LR
    User --> Loadbalancer
    Loadbalancer --> |"Network Traffic(100%)"|Application-Version-1

</div>
<ul>
<li>Phase 2</li>
</ul>
<div class="mermaid">
    
flowchart LR
    User --> Loadbalancer
    Loadbalancer --> |"Network Traffic(90%)"|Application-Version-1
    Loadbalancer -.- |"Network Traffic(10%)"|Application-Version-2

</div>
<ul>
<li>Phase 3</li>
</ul>
<div class="mermaid">
    
flowchart LR
    User --> Loadbalancer
    Loadbalancer --> |"Network Traffic(60%)"|Application-Version-1
    Loadbalancer -.- |"Network Traffic(40%)"|Application-Version-2

</div>
<ul>
<li>Phase 4</li>
</ul>
<div class="mermaid">
    
flowchart LR
    User --> Loadbalancer
    Loadbalancer --> |"Network Traffic(100%)"|Application-Version-2

</div>
<h4 id="ab-testing">A/B Testing</h4>
<p>A/B Testingä¸€èˆ¬æ˜¯ç”¨äºæ¯”è¾ƒã€è¯„ä¼°æŸä¸€åŠŸèƒ½ä¸åŒç‰ˆæœ¬ä»¥ç¡®å®šå“ªä¸ªç‰ˆæœ¬çš„è¡¨ç°ã€æ•ˆæœæ›´å¥½ã€‚A/B Testingä¸€èˆ¬åŸºäºLoadBalancerçš„Dynamic Routingè¿›è¡Œå®ç°ï¼Œå°†ç”¨æˆ·åˆ†ä¸ºA/Bä¸¤ç»„ï¼ŒAï¼ˆcontrol groupï¼‰ä¸ºæ§åˆ¶ç»„ç»§ç»­ä½¿ç”¨æ—§ç‰ˆæœ¬åŠŸèƒ½ï¼ŒBï¼ˆtreatment groupï¼‰ä¸ºæ²»ç–—ç»„ï¼Œæ ¹æ®ç‰¹å®šçš„ç”¨æˆ·æ ‡ç­¾è¿›è¡Œè·¯ç”±ï¼Œä½¿ç”¨æ–°ç‰ˆæœ¬åŠŸèƒ½ã€‚</p>
<div class="mermaid">
    
flowchart LR
    User --> Loadbalancer
    Loadbalancer --> Application-Version-1
    Loadbalancer --> |"Dynamic Routing Beta User"|Application-Version-2

</div>
<h2 id="æ¸è¿›å¼äº¤ä»˜ä¸kubernetes-workloads">æ¸è¿›å¼äº¤ä»˜ä¸Kubernetes Workloads</h2>
<p>Kubernetes Workloadsæ˜¯æŒ‡åœ¨Kubernetesä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºï¼ŒKubernetesæä¾›çš„Workloadsä¸€èˆ¬å­˜åœ¨äºGroup apps/batchä¸‹ï¼Œå¦‚å¸¸è§çš„Deploymentã€StatefulSetã€DaemonSetã€CronJob; é€šè¿‡å¯¹åº”çš„æ§åˆ¶å™¨ï¼Œè¾¾åˆ°å¯¹ä¸€ç»„Podè¿è¡ŒçŠ¶æ€çš„ç®¡æ§ã€‚</p>
<p>å…¶ä¸­Deploymentä¸StatefulSetéƒ½æ˜¯é‡‡ç”¨æ»šåŠ¨å‡çº§çš„ç­–ç•¥è¿›è¡Œå‘å¸ƒï¼›</p>
<ul>
<li>Deploymentæ»šåŠ¨å‡çº§ç­–ç•¥ï¼šæä¾›äº†maxUnavailableï¼ˆå‘å¸ƒè¿‡ç¨‹æœ€å¤§ä¸å¯ç”¨æ•°é‡ï¼‰å’ŒmaxSurgeï¼ˆå‘å¸ƒè¿‡ç¨‹å¯è¶…è¿‡replicasçš„æœ€å¤§å¼¹æ€§æ•°é‡ï¼‰å‚æ•°è¿›è¡Œæ»šåŠ¨å‡çº§çš„æ§åˆ¶ã€‚</li>
<li>StatefulSetæ»šåŠ¨å‡çº§ç­–ç•¥ï¼šæä¾›äº†partitionå‚æ•°æ§åˆ¶éœ€è¦æ›´æ–°çš„Podï¼ˆordinal&gt;=partitionï¼‰å’ŒmaxUnavailableï¼ˆå‘å¸ƒè¿‡ç¨‹ä¸­æœ€å¤§ä¸å¯ç”¨æ•°é‡ï¼‰å‚æ•°è¿›è¡Œæ»šåŠ¨å‡çº§çš„æ§åˆ¶ã€‚</li>
</ul>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒKubernetesæä¾›çš„WorkloadsåŠŸèƒ½ç±»ä¼¼äºæµå¼å…¨é‡å‘å¸ƒã€æµå¼åˆ†æ‰¹å‘å¸ƒï¼Œå¯¹æ¸è¿›å¼äº¤ä»˜çš„æ”¯æŒä¸è¶³ï¼Œç¼ºå°‘äº†æµé‡å‘å¸ƒã€è¿›åº¦ç®¡æ§çš„åŠŸèƒ½ï¼Œè¿™ä¹Ÿè¡ç”Ÿäº†ä¸€äº›æ”¯æŒæ¸è¿›å¼äº¤ä»˜çš„Kubernetes Controllerï¼Œå¦‚Argo Rolloutsã€Flaggerã€‚Argo Rolloutsä¸Flaggerä¹Ÿä»£è¡¨äº†ä¸»æµçš„ä¸¤ç§Kubernetesæ¸è¿›å¼äº¤ä»˜æ§åˆ¶å™¨çš„å®ç°æ–¹å¼ï¼š</p>
<ul>
<li>Argo Rolloutsï¼šArgo Rollouts è®¾è®¡äº†CRD Rollout ä¸ Rollout Controllerï¼Œé€šè¿‡é‡å†™äº†åŸæœ‰Deploymentçš„åŠŸèƒ½å®ç°å¯¹RolloutåŠŸèƒ½è¿›è¡Œäº†æ‰©å±•ã€‚</li>
</ul>
<!-- raw HTML omitted -->
<p>
<div class="post-img-view">
    <a data-fancybox="gallery" data-src="https://github.com/ChinaLHR/ChinaLHR.github.io/assets/19829495/582b1e5b-61dc-4f97-a161-b8bb24624334">
    <img src="https://github.com/ChinaLHR/ChinaLHR.github.io/assets/19829495/582b1e5b-61dc-4f97-a161-b8bb24624334" alt="image"  />
    </a>
</div></p>
<ul>
<li>Flaggerï¼šFlagger åˆ™æ˜¯åœ¨ç°æœ‰çš„Deploymentä¸Šè¿›è¡Œæ‰©å±•ï¼Œè®¾è®¡äº†CRD Rollout ä¸ Rollout Controllerï¼Œåœ¨Kubernetes Deploymentéƒ¨ç½²æ—¶è¿›è¡ŒåŠŸèƒ½çš„å¢å¼ºã€‚</li>
</ul>
<!-- raw HTML omitted -->
<p>
<div class="post-img-view">
    <a data-fancybox="gallery" data-src="https://github.com/ChinaLHR/ChinaLHR.github.io/assets/19829495/1f671e1c-b80a-43aa-915c-8e7831a29e7d">
    <img src="https://github.com/ChinaLHR/ChinaLHR.github.io/assets/19829495/1f671e1c-b80a-43aa-915c-8e7831a29e7d" alt="image"  />
    </a>
</div></p>
<p>Argo Rolloutsçš„ä¼˜åŠ¿æ˜¯Workloadså·²ç»å†…ç½®äº†Rolloutsçš„èƒ½åŠ›ï¼Œé…ç½®ä¸å®ç°ç®€å•ï¼Œå®šåˆ¶åŒ–èƒ½åŠ›å¼ºï¼›ç¼ºç‚¹æ˜¯å¯¹äºä¸€äº›ç¤¾åŒºæ–¹æ¡ˆï¼ŒåŸºäºæ ‡å‡†Kubernetes Workloadsä¸ç³»ç»Ÿå­˜é‡çš„Deploymentéœ€è¦è¿›è¡Œæ”¹é€ é€‚é…ã€‚
Flagger çš„ä¼˜åŠ¿æ˜¯æ”¯æŒæ ‡å‡†Kubernetes Workloadsï¼Œä¸ç¤¾åŒºæ–¹æ¡ˆå…¼å®¹æ€§å¼ºï¼Œç¼ºç‚¹æ˜¯å‘å¸ƒè¿‡ç¨‹ä¸­å­˜åœ¨Double Workloads èµ„æºçš„é—®é¢˜ï¼Œå‘å¸ƒä¼šå…ˆå‡çº§ç”¨æˆ·éƒ¨ç½²çš„ Workloadsï¼Œå†å‡çº§ Primaryï¼ˆå®é™…è¿è¡Œçš„ï¼‰ï¼Œåœ¨è¿™è¿‡ç¨‹ä¸­éœ€è¦å‡†å¤‡åŒå€Podèµ„æºçš„æ¶ˆè€—ã€‚</p>
<h2 id="argo-rollouts">Argo Rollouts</h2>
<h3 id="argo-rolloutsæ¦‚è¿°">Argo Rolloutsæ¦‚è¿°</h3>
<p>Argo Rolloutsç”±ä¸€ä¸ªKubernetes Controllerä¸ä¸€ç»„Kubernetes CRDç»„æˆï¼Œä¸ºKubernetesæä¾›æ›´é«˜çº§éƒ¨ç½²åŠŸèƒ½ï¼Œå¦‚è“ç»¿(blue-green)ã€é‡‘ä¸é›€(canary)ã€é‡‘ä¸é›€åˆ†æ(canary analysis)ã€å®éªŒ(experimentation)å’Œæ¸è¿›å¼äº¤ä»˜åŠŸèƒ½ã€‚</p>
<p><strong>Argo Rollouts Controllerç‰¹æ€§</strong></p>
<ul>
<li>è“ç»¿(blue-green)/é‡‘ä¸é›€(canary)æ›´æ–°ç­–ç•¥</li>
<li>ç»†ç²’åº¦åŠ æƒæµé‡æ‹†åˆ†</li>
<li>è‡ªåŠ¨å›æ»šã€è‡ªåŠ¨æ¨è¿›ï¼Œä¹Ÿæ”¯æŒæ‰‹åŠ¨å¤„ç†</li>
<li>æ”¯æŒå¤šç§MetricsæŒ‡æ ‡é›†æˆä»¥è¿›è¡Œè“ç»¿å’Œé‡‘ä¸é›€åˆ†æ</li>
<li>ä¸Ingressã€Service Meshé›†æˆï¼Œå®ç°é«˜çº§æµé‡è·¯ç”±</li>
</ul>
<p><strong>Argo Rollouts Controllerå·¥ä½œåŸç†</strong></p>
<p>ä¸Kubernetes Deploymentç±»ä¼¼ï¼ŒArgo Rollouts Controllerç®¡ç†ReplicaSetsçš„åˆ›å»ºã€ç¼©æ”¾å’Œåˆ é™¤ã€‚è¿™äº› ReplicaSet ç”±<code>spec.templateRollout</code> èµ„æºä¸­çš„å­—æ®µå®šä¹‰ï¼Œä¸Deployment ä½¿ç”¨ç›¸åŒçš„podæ¨¡æ¿ã€‚</p>
<p>å½“<code>spec.template</code>æ›´æ”¹æ—¶ï¼Œä¼šå‘Argo Rollouts Controllerå‘å‡ºä¿¡å·é€šçŸ¥ï¼Œå‘ŠçŸ¥å°†å¼•å…¥æ–°çš„ ReplicaSetã€‚Argo Rollouts Controllerå°†ä½¿ç”¨è¯¥<code>spec.strategy</code>å­—æ®µä¸­å®šä¹‰çš„ç­–ç•¥æ¥ç¡®å®šæ—§ReplicaSetåˆ°æ–°ReplicaSetçš„å‘å¸ƒæ–¹å¼ã€‚ä¸€æ—¦æ–°çš„ReplicaSetè¢«æ”¾å¤§ï¼ˆå¯é€‰æ‹©é€šè¿‡Analysisè¿›è¡Œæ§åˆ¶ï¼‰ï¼Œæ§åˆ¶å™¨ä¼šå°†å…¶æ ‡è®°ä¸ºâ€œç¨³å®šâ€ã€‚</p>
<p>å¦‚æœåœ¨<code>spec.template</code>ä»ç¨³å®šçš„ReplicaSetè¿‡æ¸¡åˆ°æ–°çš„ReplicaSetçš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†å˜åŒ–ï¼ˆå‘å¸ƒè¿‡ç¨‹ä¸­æ›´æ”¹äº†åº”ç”¨ç‰ˆæœ¬ä¿¡æ¯ï¼‰ï¼Œé‚£ä¹ˆæ–°ReplicaSetå°†è¢«ç¼©å°ï¼ŒArgo Rollouts Controllerä¼šå°è¯•åæ˜ æ›´æ–°spec.templateå­—æ®µçš„ReplicaSetã€‚</p>
<h3 id="argo-rollouts-æ¶æ„">Argo Rollouts æ¶æ„</h3>
<p>
<div class="post-img-view">
    <a data-fancybox="gallery" data-src="https://user-images.githubusercontent.com/19829495/196354253-d3b751c4-0d9d-4d76-9666-3921e62d1af2.png">
    <img src="https://user-images.githubusercontent.com/19829495/196354253-d3b751c4-0d9d-4d76-9666-3921e62d1af2.png" alt="image"  />
    </a>
</div></p>
<ul>
<li>Rollout Controller</li>
</ul>
<p>æ ¸å¿ƒControllerï¼Œç›‘æ§é›†ç¾¤äº‹ä»¶å¹¶åœ¨Rolloutèµ„æºç±»å‹å‘ç”Ÿå˜æ›´æ—¶åšå‡ºååº”ï¼Œè¯»å–éƒ¨ç½²rollout CRDèµ„æºä¿¡æ¯ï¼Œå°†é›†ç¾¤ç½®äºéƒ¨ç½²å®šä¹‰ä¸­æè¿°çš„ç›¸åŒçŠ¶æ€ã€‚
è€Œä¸”ï¼ŒArgo Rollouts ä¸ä¼šç¯¡æ”¹æˆ–å“åº”æ­£å¸¸éƒ¨ç½²èµ„æºä¸Šå‘ç”Ÿçš„ä»»ä½•æ›´æ”¹ã€‚</p>
<ul>
<li>Rollout Resouces</li>
</ul>
<p>Rollout Resoucesæ˜¯Argo Rolloutså¼•å…¥å’Œç®¡ç†çš„Kubernetes CRDèµ„æºã€‚å®ƒä¸åŸç”ŸKubernetes Deploymentèµ„æºå…¼å®¹ï¼Œé€šè¿‡é¢å¤–çš„å­—æ®µæä¾›äº†é«˜çº§æ§åˆ¶éƒ¨ç½²æ–¹æ³•ï¼ˆå¦‚â€‹â€‹é‡‘ä¸é›€å’Œè“/ç»¿ï¼‰ã€‚</p>
<ul>
<li>Ingress/Service</li>
</ul>
<p>Argo Rolloutså¯ä»¥è¿›è¡Œçµæ´»çš„ç½‘ç»œé…ç½®ï¼Œåœ¨rolloutsæœŸé—´æ‹¥æœ‰ä¸åŒçš„Serviceï¼ˆå¦‚ä»…é€‚ç”¨äºæ–°ç‰ˆæœ¬ã€ä»…é€‚ç”¨äºæ—§ç‰ˆæœ¬ã€æ–°æ—§ç‰ˆæœ¬ç»“åˆç±»å‹çš„Serviceï¼‰ã€‚ä¸“é—¨é’ˆå¯¹Canaryéƒ¨ç½²ï¼ŒArgo Rolloutsæ”¯æŒå¤šç§æœåŠ¡ç½‘æ ¼å’Œå…¥å£è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚ç”¨äºä»¥ç‰¹å®šç™¾åˆ†æ¯”æ‹†åˆ†æµé‡ï¼Œè€Œä¸æ˜¯åŸºäºpodæ•°é‡çš„ç®€å•å¹³è¡¡ã€‚</p>
<ul>
<li>Analysis/AnalysisRun</li>
</ul>
<p>Analysisä¸AnalysisRunæ˜¯Argo Rolloutså¼•å…¥å’Œç®¡ç†çš„Kubernetes CRDèµ„æºã€‚Analysiså°†Rolloutè¿æ¥åˆ°æŒ‡æ ‡æä¾›ç¨‹åº(å¦‚prometheus)ï¼Œå¹¶ä¸ºæŒ‡æ ‡å®šä¹‰é˜ˆå€¼ï¼Œé˜ˆå€¼å°†å†³å®šRolloutæ˜¯å¦æˆåŠŸä»¥åŠåç»­çš„æ“ä½œï¼ˆç»§ç»­å‘å¸ƒã€å›æ»šï¼Œæš‚åœå‘å¸ƒï¼‰ã€‚
Analysisæ˜¯æŸ¥è¯¢æŒ‡æ ‡çš„æ¨¡æ¿ï¼ŒAnalysisRunæ‰æ˜¯é™„åŠ åˆ°Rolloutçš„èµ„æºï¼Œå› æ­¤å¯ä»¥åœ¨ç‰¹å®šRolloutä¸Šæˆ–åœ¨é›†ç¾¤ä¸Šå¯¹Analysisè¿›è¡Œå…¨å±€å®šä¹‰ï¼Œä»¥ä¾›å¤šä¸ªrolloutå…±äº«ã€‚</p>
<h3 id="å®‰è£…argo-rollouts">å®‰è£…Argo Rollouts</h3>
<ul>
<li>å®‰è£…Argo Rollouts</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl create namespace argo-rollouts
kubectl apply -n argo-rollouts -f https://github.com/argoproj/argo-rollouts/releases/latest/download/install.yaml
</code></pre></div><ul>
<li>å®‰è£…Argo Rollouts Kubectl æ’ä»¶ (Linux platform)</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl -LO https://github.com/argoproj/argo-rollouts/releases/latest/download/kubectl-argo-rollouts-linux-amd64
chmod +x kubectl-argo-rollouts-linux-amd64
sudo mv ./kubectl-argo-rollouts-linux-amd64 /usr/local/bin/kubectl-argo-rollouts
kubectl argo rollouts version
</code></pre></div><ul>
<li>Argo Rollouts Dashboard</li>
</ul>
<p>åœ¨åŒ…å«Rolloutsèµ„æºå¯¹è±¡çš„å‘½åç©ºé—´ä¸­è¿è¡Œ<code>kubectl argo rollouts dashboard</code>å‘½ä»¤ï¼Œè®¿é—®æœ¬åœ°3100ç«¯å£è¿›è¡ŒæŸ¥çœ‹ã€‚</p>
<h2 id="åŸºäºargo-rolloutsçš„æ¸è¿›å¼äº¤ä»˜å®è·µ">åŸºäºArgo Rolloutsçš„æ¸è¿›å¼äº¤ä»˜å®è·µ</h2>
<h3 id="åŸºæœ¬ä½¿ç”¨">åŸºæœ¬ä½¿ç”¨</h3>
<p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨kustomizeç»“åˆArgo Rolloutsè¿›è¡Œæ¼”ç¤ºï¼Œå› æ­¤éœ€è¦ä½¿ç”¨transformer configså¯¹kustomizeè¿›è¡Œæ‰©å±•ä»¥ç†è§£CRDå¯¹è±¡ã€‚å…·ä½“é…ç½®å¯ä»¥å‚è€ƒï¼š<a href="https://argoproj.github.io/argo-rollouts/features/kustomize/">https://argoproj.github.io/argo-rollouts/features/kustomize/</a>ä¸é¡¹ç›®/.kubernetes/overlays/manualã€‚</p>
<ul>
<li>Rolloutéƒ¨ç½²</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml"><span style="color:#75715e"># rollouts</span>
<span style="color:#66d9ef">apiVersion</span>: argoproj.io/v1alpha1
<span style="color:#66d9ef">kind</span>: Rollout
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: saken-manual
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">replicas</span>: <span style="color:#ae81ff">5</span>
  <span style="color:#66d9ef">strategy</span>:
    <span style="color:#66d9ef">canary</span>:
      <span style="color:#66d9ef">steps</span>:
      - <span style="color:#66d9ef">setWeight</span>: <span style="color:#ae81ff">20</span>
      - <span style="color:#66d9ef">pause</span>: {}
      - <span style="color:#66d9ef">setWeight</span>: <span style="color:#ae81ff">40</span>
      - <span style="color:#66d9ef">pause</span>: {<span style="color:#66d9ef">duration</span>: <span style="color:#ae81ff">10</span>}
      - <span style="color:#66d9ef">setWeight</span>: <span style="color:#ae81ff">60</span>
      - <span style="color:#66d9ef">pause</span>: {<span style="color:#66d9ef">duration</span>: <span style="color:#ae81ff">10</span>}
      - <span style="color:#66d9ef">setWeight</span>: <span style="color:#ae81ff">80</span>
      - <span style="color:#66d9ef">pause</span>: {<span style="color:#66d9ef">duration</span>: <span style="color:#ae81ff">10</span>}
  <span style="color:#66d9ef">revisionHistoryLimit</span>: <span style="color:#ae81ff">2</span>
  <span style="color:#66d9ef">selector</span>:
    <span style="color:#66d9ef">matchLabels</span>:
      <span style="color:#66d9ef">app</span>: saken-manual
  <span style="color:#66d9ef">template</span>:
    <span style="color:#66d9ef">metadata</span>:
      <span style="color:#66d9ef">labels</span>:
        <span style="color:#66d9ef">app</span>:  saken-manual
    <span style="color:#66d9ef">spec</span>:
      <span style="color:#66d9ef">containers</span>:
      - <span style="color:#66d9ef">name</span>:  saken-manual
        <span style="color:#66d9ef">image</span>:  ccr.ccs.tencentyun.com/shovel/shovel-rollouts:<span style="color:#ae81ff">0.0.2</span>
        <span style="color:#66d9ef">resources</span>:
          <span style="color:#66d9ef">requests</span>:
            <span style="color:#66d9ef">cpu</span>: 10m
            <span style="color:#66d9ef">memory</span>: 32Mi
        <span style="color:#66d9ef">ports</span>:
        - <span style="color:#66d9ef">containerPort</span>:  <span style="color:#ae81ff">9099</span>
          <span style="color:#66d9ef">name</span>:  saken-manual
<span style="color:#75715e"># service</span>
<span style="color:#66d9ef">apiVersion</span>: v1
<span style="color:#66d9ef">kind</span>: Service
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: saken-manual-lb
  <span style="color:#66d9ef">namespace</span>: default
  <span style="color:#66d9ef">annotations</span>:
    <span style="color:#66d9ef">prometheus.io/path</span>: /metrics
    <span style="color:#66d9ef">prometheus.io/scrape</span>: <span style="color:#e6db74">&#34;true&#34;</span>
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">selector</span>:
    <span style="color:#66d9ef">app</span>: saken-manual
  <span style="color:#66d9ef">type</span>: ClusterIP
  <span style="color:#66d9ef">sessionAffinity</span>: None
  <span style="color:#66d9ef">sessionAffinityConfig</span>:
    <span style="color:#66d9ef">clientIP</span>:
      <span style="color:#66d9ef">timeoutSeconds</span>: <span style="color:#ae81ff">10800</span>
  <span style="color:#66d9ef">ports</span>:
  - <span style="color:#66d9ef">name</span>: saken-manual
    <span style="color:#66d9ef">protocol</span>: TCP
    <span style="color:#66d9ef">port</span>: <span style="color:#ae81ff">80</span>
    <span style="color:#66d9ef">targetPort</span>: <span style="color:#ae81ff">9099</span>
<span style="color:#75715e"># kustomization</span>
<span style="color:#66d9ef">apiVersion</span>: kustomize.config.k8s.io/v1beta1
<span style="color:#66d9ef">kind</span>: Kustomization
<span style="color:#66d9ef">resources</span>:
- ../../base
<span style="color:#66d9ef">namespace</span>: staging
<span style="color:#66d9ef">resources</span>:
- base-rollout.yaml
- base-service.yaml
<span style="color:#66d9ef">images</span>:
- <span style="color:#66d9ef">name</span>: ccr.ccs.tencentyun.com/shovel/shovel-rollouts
  <span style="color:#66d9ef">newTag</span>: <span style="color:#ae81ff">0.0.3</span>         
</code></pre></div><p>è¿™é‡Œæˆ‘ä»¬kustomizationé…ç½®äº†ä¸€ä¸ªRolloutä¸å¯¹åº”çš„Serviceï¼ŒRolloutä½¿ç”¨Canaryéƒ¨ç½²ç­–ç•¥ï¼Œå°†20%çš„æµé‡éƒ¨ç½²åˆ°Canaryåï¼ŒRolloutè¿›å…¥PausedçŠ¶æ€ï¼Œ
è¿›è¡Œæ‰‹åŠ¨promoteåï¼Œæ¯é—´éš”10sè¿›è¡Œé€æ­¥åœ°å‡çº§ã€‚</p>
<p>é€šè¿‡å¦‚ä¸‹å‘½ä»¤è¿›è¡Œéƒ¨ç½²ï¼Œæ³¨æ„æ‰€æœ‰çš„Rolloutçš„åˆå§‹åˆ›å»ºï¼Œå› ä¸ºæ²¡ç”¨ä»»ä½•å‡çº§ï¼Œæ‰€ä»¥ä¼šç«‹å³å°†å‰¯æœ¬æ‰©å±•åˆ°100%ï¼ˆè·³è¿‡canaryã€analyseç­‰ï¼‰ã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl apply -k .kubernetes/overlays/manual
kubectl argo rollouts get rollout saken-manual -n staging --watch
</code></pre></div><p>
<div class="post-img-view">
    <a data-fancybox="gallery" data-src="https://user-images.githubusercontent.com/19829495/196662807-1d629fc7-7bbc-456a-ae23-4d66d7c54bcf.png">
    <img src="https://user-images.githubusercontent.com/19829495/196662807-1d629fc7-7bbc-456a-ae23-4d66d7c54bcf.png" alt="image"  />
    </a>
</div></p>
<ul>
<li>æ›´æ–°Rollout</li>
</ul>
<p>ä½¿ç”¨<code>kustomize edit</code>å‘½ä»¤æ›´æ–°æˆ–è€…å¯¹kustomizationæ–‡ä»¶è¿›è¡Œæ›´æ–°ï¼Œé€šè¿‡å¦‚ä¸‹å‘½ä»¤è¿›è¡Œéƒ¨ç½²ï¼Œå¯ä»¥çœ‹åˆ°canaryéƒ¨ç½²ç­–ç•¥å·²ç»ç”Ÿæ•ˆäº†,æ­¤æ—¶å·²ç»å°†20%çš„æµé‡éƒ¨ç½²åˆ°cancaryï¼Œå¹¶è¿›å…¥äº†PausedçŠ¶æ€ã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl apply -k .kubernetes/overlays/manual
kubectl argo rollouts get rollout saken-manual -n staging --watch
</code></pre></div><p>
<div class="post-img-view">
    <a data-fancybox="gallery" data-src="https://user-images.githubusercontent.com/19829495/196663846-ec72a898-73df-4822-ac94-586e5c2453dc.png">
    <img src="https://user-images.githubusercontent.com/19829495/196663846-ec72a898-73df-4822-ac94-586e5c2453dc.png" alt="image"  />
    </a>
</div></p>
<ul>
<li>Promote/Abort Rollout</li>
</ul>
<p>Rolloutå¤„äºPausedçŠ¶æ€åï¼Œå¯ä»¥æ‰‹åŠ¨è¿›è¡ŒPromote/Abortæ“ä½œï¼Œå¦‚ä¸‹å‘½ä»¤æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Promoting a Rollout</span>
kubectl argo rollouts promote saken-manual -n staging
<span style="color:#75715e"># Aborting a Rollout</span>
<span style="color:#75715e"># kubectl argo rollouts abort saken-manual -n staging</span>
kubectl argo rollouts get rollout saken-manual -n staging --watch
</code></pre></div><p>
<div class="post-img-view">
    <a data-fancybox="gallery" data-src="https://user-images.githubusercontent.com/19829495/196665933-348293e8-bc91-449c-8645-a97833136b56.png">
    <img src="https://user-images.githubusercontent.com/19829495/196665933-348293e8-bc91-449c-8645-a97833136b56.png" alt="image"  />
    </a>
</div></p>
<h3 id="argo-rollout-analysis">Argo Rollout Analysis</h3>
<p>Argo Rollouts æä¾›äº†å¤šç§æ‰§è¡Œåˆ†æ(Analysis)çš„æ–¹æ³•æ¥æ¨åŠ¨æ¸è¿›å¼äº¤ä»˜ï¼Œä¸ºæ­¤ä¹Ÿå®šä¹‰äº†å¦‚ä¸‹CRD:</p>
<table>
<thead>
<tr>
<th>CRD</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AnalysisTemplate</td>
<td>Analysisæ¨¡æ¿ï¼Œå®šä¹‰äº†å¦‚ä½•æ‰§è¡Œcanaryåˆ†æï¼Œå¦‚æ‰§è¡Œçš„æŒ‡æ ‡ã€é¢‘ç‡ã€æˆåŠŸæˆ–å¤±è´¥çš„é˜ˆå€¼ã€‚AnalysisTemplatesè¿˜æ”¯æŒé€šè¿‡è¾“å…¥å€¼è¿›è¡Œå‚æ•°åŒ–ã€‚</td>
</tr>
<tr>
<td>ClusterAnalysisTemplate</td>
<td>ç±»ä¼¼äºAnalysisTemplateï¼Œä½†ä¸é™äºå…¶namespaceï¼Œå¯ä»¥è¢«é›†ç¾¤ä¸­çš„ä»»ä½•Rolloutä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>AnalysisRun</td>
<td>å®ä¾‹åŒ–AnalysisTemplateã€‚AnalysisRunsç±»ä¼¼äºJobsï¼Œæœ€ç»ˆéƒ½ä¼šå®Œæˆã€‚å·²å®Œæˆçš„è¿è¡Œè¢«è§†ä¸ºæˆåŠŸã€å¤±è´¥æˆ–ä¸ç¡®å®šï¼Œè¿è¡Œç»“æœä¼šå½±å“Rolloutçš„æ¨è¿›æ˜¯å¦ç»§ç»­ã€ä¸­æ­¢æˆ–æš‚åœã€‚</td>
</tr>
<tr>
<td>Experiment</td>
<td>å…è®¸ç”¨æˆ·ä¸´æ—¶è¿è¡Œä¸€ä¸ªæˆ–å¤šä¸ªReplicaSetã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒExperimentè¿˜å¯ä»¥ä¸ReplicaSetä¸€èµ·å¯åŠ¨AnalysisRunsã€‚é€šå¸¸ï¼Œè¿™äº›AnalysisRunç”¨äºç¡®è®¤æ–°çš„ReplicaSetæ˜¯å¦æŒ‰é¢„æœŸè¿è¡Œã€‚</td>
</tr>
</tbody>
</table>
<p>Argo Rollout Analysis æ”¯æŒå¤šç§åˆ†ææ¨¡å¼ï¼š</p>
<ul>
<li>Background Analysisï¼šåå°åˆ†æï¼Œcanaryéƒ¨ç½²æ­¥éª¤æ‰§è¡Œæ—¶ï¼Œå¯ä»¥åœ¨åå°è¿›è¡ŒAnalysisRunåˆ†æï¼Œä»¥åˆ†æç»“æœå†³å®šcanary rolloutçš„åç»­è¡Œä¸ºï¼ˆæ¨è¿›/ç»ˆæ­¢ï¼‰ã€‚</li>
<li>Inline Analysisï¼šå†…è”åˆ†æï¼Œcanaryéƒ¨ç½²æ­¥éª¤æ‰§è¡Œæ—¶ï¼Œåœ¨åˆ°è¾¾æŸä¸€é˜¶æ®µæ—¶å¯åŠ¨AnalysisRunï¼Œå¹¶åœ¨è¿è¡Œå®Œæˆä¹‹å‰é˜»æ­¢å…¶æ¨è¿›ï¼Œä»¥åˆ†æç»“æœå†³å®šcanary rolloutçš„åç»­è¡Œä¸ºï¼ˆæ¨è¿›/ç»ˆæ­¢ï¼‰ã€‚</li>
<li>Analysis with Multiple Templatesï¼šå¤šæ¨¡æ¿åˆ†æï¼Œåœ¨æ„å»ºAnalysisRunæ—¶ï¼ŒRolloutå¯ä»¥å¼•ç”¨å¤šä¸ª AnalysisTemplateï¼Œå…è®¸ä»å¤šä¸ª AnalysisTemplate è¿›è¡Œåˆ†æã€‚</li>
<li>Analysis Template Argumentsï¼šAnalysisTemplateså¯ä»¥å£°æ˜ä¸€ç»„å¯ä»¥ç”±Rolloutsä¼ é€’çš„å‚æ•°ã€‚</li>
<li>BlueGreen Pre Promotion Analysis/BlueGreen Post Promotion Analysisï¼šä½¿ç”¨BlueGreenç­–ç•¥çš„Rolloutå¯ä»¥åœ¨æµé‡åˆ‡æ¢åˆ°æ–°ç‰ˆæœ¬å‰åå¯åŠ¨AnalysisRunè¿›è¡Œåˆ†æï¼Œæ ¹æ®åˆ†æç»“æœå†³å®šæ˜¯å¦åˆ‡æ¢æµé‡ã€‚</li>
</ul>
<p>æ›´å¤šå†…å®¹å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://argoproj.github.io/argo-rollouts/features/analysis/">https://argoproj.github.io/argo-rollouts/features/analysis/</a></p>
<h3 id="canary-analysisé‡‘ä¸é›€åˆ†æ">Canary-Analysis(é‡‘ä¸é›€åˆ†æ)</h3>
<p>è¿™é‡Œä½¿ç”¨Background Analysisç»“åˆCanaryéƒ¨ç½²ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œé…ç½®äº†ä¸€ä¸ªRolloutï¼Œä¸å¯¹åº”çš„AnalysisTemplateï¼ŒServiceã€‚rolloutæ¯10åˆ†é’Ÿé€æ¸å¢åŠ canaryæƒé‡20%ï¼Œç›´åˆ°è¾¾åˆ°100%ã€‚åå°ï¼ŒAnalysisRunåŸºäºAnalysisTemplateï¼Œè¯¥åˆ†ææ¨¡æ¿ä»¥ä¸€ä¸‹æ–¹å¼è¿è¡Œï¼š</p>
<ul>
<li>ä»PrometheusæœåŠ¡è·å–æŒ‡æ ‡ä¿¡æ¯ï¼Œä»¥äº”åˆ†é’Ÿä¸ºé—´éš”ï¼Œæµ‹é‡äº”åˆ†é’Ÿå†…å¯¹åº”æœåŠ¡çš„HTTPæˆåŠŸç‡ï¼Œæ ¹æ®ç»™å®šçš„åº¦é‡é˜ˆå€¼ï¼ˆsuccessCondition=90%ï¼‰ä»¥åŠå¤±è´¥æ¬¡æ•°çš„é˜ˆå€¼ï¼ˆfailureLimit=2ï¼‰è®¡ç®—å¾—å‡ºæµ‹é‡ç»“æœï¼Œå¦‚æµ‹é‡æˆåŠŸç‡ä¸ºå°äº90%å¹¶ä¸”å­˜åœ¨ä¸¤ä¸ªè¿™æ ·çš„æµ‹é‡ç»“æœï¼Œåˆ™è¢«è®¤ä¸ºåˆ†æå¤±è´¥ã€‚</li>
<li>å¤±è´¥çš„åˆ†æç»“æœä¼šä½¿Rolloutä¸­æ­¢ï¼Œå°†Canaryæƒé‡è®¾ç½®å›é›¶ï¼Œå¹¶ä¸”Rolloutå°†è¢«è§†ä¸ºDegradedï¼ˆé™çº§ï¼‰ã€‚</li>
<li>å¦‚æœRolloutå®Œæˆå…¶æ‰€æœ‰Canaryæ­¥éª¤ï¼Œåˆ™è®¤ä¸ºRolloutæˆåŠŸéƒ¨ç½²ï¼Œæ§åˆ¶å™¨å°†åœæ­¢è¿è¡Œåˆ†æã€‚</li>
<li>è¿™é‡Œä½¿ç”¨äº†Rolloutçš„analysis-startingStepé…ç½®ä¸º2ï¼Œå³ä¼šå»¶è¿Ÿæ‰§è¡ŒAnalysisRunï¼Œç›´åˆ°Canaryè¾¾åˆ°40%ã€‚</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml"><span style="color:#75715e"># Rollout</span>
<span style="color:#66d9ef">apiVersion</span>: argoproj.io/v1alpha1
<span style="color:#66d9ef">kind</span>: Rollout
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: saken-canary
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">replicas</span>: <span style="color:#ae81ff">5</span>
  <span style="color:#66d9ef">strategy</span>:
    <span style="color:#66d9ef">canary</span>:
      <span style="color:#66d9ef">analysis</span>:
        <span style="color:#66d9ef">templates</span>:
        - <span style="color:#66d9ef">templateName</span>: canary-success-rate
        <span style="color:#66d9ef">startingStep</span>: <span style="color:#ae81ff">2</span>
        <span style="color:#66d9ef">args</span>:
        - <span style="color:#66d9ef">name</span>: service-name
          <span style="color:#66d9ef">value</span>: saken-canary-lb
      <span style="color:#66d9ef">steps</span>:
      - <span style="color:#66d9ef">setWeight</span>: <span style="color:#ae81ff">20</span>
      - <span style="color:#66d9ef">pause</span>: {<span style="color:#66d9ef">duration</span>: 10m}
      - <span style="color:#66d9ef">setWeight</span>: <span style="color:#ae81ff">40</span>
      - <span style="color:#66d9ef">pause</span>: {<span style="color:#66d9ef">duration</span>: 10m}
      - <span style="color:#66d9ef">setWeight</span>: <span style="color:#ae81ff">60</span>
      - <span style="color:#66d9ef">pause</span>: {<span style="color:#66d9ef">duration</span>: 10m}
      - <span style="color:#66d9ef">setWeight</span>: <span style="color:#ae81ff">80</span>
      - <span style="color:#66d9ef">pause</span>: {<span style="color:#66d9ef">duration</span>: 10m}
  <span style="color:#66d9ef">revisionHistoryLimit</span>: <span style="color:#ae81ff">2</span>
  <span style="color:#66d9ef">selector</span>:
    <span style="color:#66d9ef">matchLabels</span>:
      <span style="color:#66d9ef">app</span>: saken-canary
  <span style="color:#66d9ef">template</span>:
    <span style="color:#66d9ef">metadata</span>:
      <span style="color:#66d9ef">labels</span>:
        <span style="color:#66d9ef">app</span>:  saken-canary
    <span style="color:#66d9ef">spec</span>:
      <span style="color:#66d9ef">containers</span>:
      - <span style="color:#66d9ef">name</span>:  saken-canary
        <span style="color:#66d9ef">image</span>:  ccr.ccs.tencentyun.com/shovel/shovel-rollouts:<span style="color:#ae81ff">0.0.2</span>
        <span style="color:#66d9ef">resources</span>:
          <span style="color:#66d9ef">requests</span>:
            <span style="color:#66d9ef">cpu</span>: 10m
            <span style="color:#66d9ef">memory</span>: 32Mi
        <span style="color:#66d9ef">ports</span>:
        - <span style="color:#66d9ef">containerPort</span>:  <span style="color:#ae81ff">9099</span>
          <span style="color:#66d9ef">name</span>:  saken-canary
<span style="color:#75715e"># Service</span>
<span style="color:#66d9ef">apiVersion</span>: v1
<span style="color:#66d9ef">kind</span>: Service
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: saken-canary-lb
  <span style="color:#66d9ef">namespace</span>: default
  <span style="color:#66d9ef">annotations</span>:
    <span style="color:#66d9ef">prometheus.io/path</span>: /metrics
    <span style="color:#66d9ef">prometheus.io/scrape</span>: <span style="color:#e6db74">&#34;true&#34;</span>
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">selector</span>:
    <span style="color:#66d9ef">app</span>: saken-canary
  <span style="color:#66d9ef">type</span>: ClusterIP
  <span style="color:#66d9ef">sessionAffinity</span>: None
  <span style="color:#66d9ef">sessionAffinityConfig</span>:
    <span style="color:#66d9ef">clientIP</span>:
      <span style="color:#66d9ef">timeoutSeconds</span>: <span style="color:#ae81ff">10800</span>
  <span style="color:#66d9ef">ports</span>:
  - <span style="color:#66d9ef">name</span>: saken-canary
    <span style="color:#66d9ef">protocol</span>: TCP
    <span style="color:#66d9ef">port</span>: <span style="color:#ae81ff">80</span>
    <span style="color:#66d9ef">targetPort</span>: <span style="color:#ae81ff">9099</span>
<span style="color:#75715e"># AnalysisTemplate</span>
<span style="color:#66d9ef">apiVersion</span>: argoproj.io/v1alpha1
<span style="color:#66d9ef">kind</span>: AnalysisTemplate
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: canary-success-rate
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">args</span>:
  - <span style="color:#66d9ef">name</span>: service-name
  <span style="color:#66d9ef">metrics</span>:
  - <span style="color:#66d9ef">name</span>: canary-success-rate
    <span style="color:#66d9ef">interval</span>: 5m
    <span style="color:#66d9ef">successCondition</span>: result[<span style="color:#ae81ff">0</span>] &gt;= <span style="color:#ae81ff">0.9</span>
    <span style="color:#66d9ef">failureLimit</span>: <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">provider</span>:
      <span style="color:#66d9ef">prometheus</span>:
        <span style="color:#66d9ef">address</span>: http://prometheus.kube-ops.svc.cluster.local
        <span style="color:#66d9ef">query</span>: <span style="color:#e6db74">|
</span><span style="color:#e6db74">          sum(irate(gin_metric_handler_http_responses_status_total{code = &#34;200&#34;,kubernetes_name = &#34;{{args.service-name}}&#34;}[5m])) /</span>
          sum(irate(gin_metric_handler_http_responses_status_total{kubernetes_name = <span style="color:#e6db74">&#34;{{args.service-name}}&#34;</span>}[5m]))
<span style="color:#75715e"># Kustomization</span>
<span style="color:#66d9ef">apiVersion</span>: kustomize.config.k8s.io/v1beta1
<span style="color:#66d9ef">kind</span>: Kustomization
<span style="color:#66d9ef">resources</span>:
- ../../base
- canary-rollout.yaml
- canary-service.yaml
- canary-success-rate.yaml

<span style="color:#66d9ef">namespace</span>: staging
<span style="color:#66d9ef">images</span>:
- <span style="color:#66d9ef">name</span>: ccr.ccs.tencentyun.com/shovel/shovel-rollouts
  <span style="color:#66d9ef">newTag</span>: <span style="color:#ae81ff">0.0.2</span>
</code></pre></div><h3 id="blue-green-analysisè“ç»¿åˆ†æ">Blue-Green-Analysis(è“ç»¿åˆ†æ)</h3>
<p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨BlueGreen Pre Promotionç»“åˆBlueGreenéƒ¨ç½²ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œé…ç½®äº†ä¸€ä¸ªRolloutï¼Œä¸å¯¹åº”çš„AnalysisTemplateï¼ŒServiceä¸Preview-Serviceã€‚Rolloutå¯¹æ–°ç‰ˆæœ¬åº”ç”¨è¿›è¡ŒBlueGreenéƒ¨ç½²æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ReplicaSetéƒ¨ç½²æ–°ç‰ˆæœ¬åº”ç”¨ï¼Œå¹¶ä¿®æ”¹Preview-Serviceä½¿å…¶selectorçš„ç›®æ ‡ä¸ºæˆ‘ä»¬åˆ›å»ºçš„æ–°ç‰ˆæœ¬åº”ç”¨ã€‚æ­¤æ—¶ï¼ŒAnalysisRunåŸºäºAnalysisTemplateï¼Œå¯¹Preview-Serviceè¿›è¡Œå†’çƒŸæµ‹è¯•å¹¶é˜»å¡Blue-Greenåˆ‡æ¢ï¼Œç›´åˆ°AnalysisRunå®Œæˆæµ‹è¯•ï¼ŒAnalysisRunçš„æµ‹è¯•ç»“æœå†³å®šäº†Rollout æ˜¯åˆ‡æ¢æµé‡æˆ–è€…è¿˜æ˜¯å®Œå…¨ä¸­æ­¢Rolloutã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml"><span style="color:#75715e"># Rollout</span>
<span style="color:#66d9ef">apiVersion</span>: argoproj.io/v1alpha1
<span style="color:#66d9ef">kind</span>: Rollout
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: saken-bluegreen
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">replicas</span>: <span style="color:#ae81ff">3</span>
  <span style="color:#66d9ef">revisionHistoryLimit</span>: <span style="color:#ae81ff">1</span>
  <span style="color:#66d9ef">strategy</span>:
    <span style="color:#66d9ef">blueGreen</span>:
      <span style="color:#66d9ef">activeService</span>: saken-bluegreen-lb
      <span style="color:#66d9ef">previewService</span>: saken-bluegreen-preview-lb
      <span style="color:#66d9ef">prePromotionAnalysis</span>:
        <span style="color:#66d9ef">templates</span>:
        - <span style="color:#66d9ef">templateName</span>: bluegreen-smoke-test
        <span style="color:#66d9ef">args</span>:
        - <span style="color:#66d9ef">name</span>: service-name
          <span style="color:#66d9ef">value</span>: saken-bluegreen-preview-lb
  <span style="color:#66d9ef">selector</span>:
    <span style="color:#66d9ef">matchLabels</span>:
      <span style="color:#66d9ef">app</span>: saken-bluegreen
  <span style="color:#66d9ef">template</span>:
    <span style="color:#66d9ef">metadata</span>:
      <span style="color:#66d9ef">labels</span>:
        <span style="color:#66d9ef">app</span>:  saken-bluegreen
    <span style="color:#66d9ef">spec</span>:
      <span style="color:#66d9ef">containers</span>:
      - <span style="color:#66d9ef">name</span>:  saken-bluegreen
        <span style="color:#66d9ef">image</span>:  ccr.ccs.tencentyun.com/shovel/shovel-rollouts:<span style="color:#ae81ff">0.0.2</span>
        <span style="color:#66d9ef">resources</span>:
          <span style="color:#66d9ef">requests</span>:
            <span style="color:#66d9ef">cpu</span>: 10m
            <span style="color:#66d9ef">memory</span>: 32Mi
        <span style="color:#66d9ef">ports</span>:
        - <span style="color:#66d9ef">containerPort</span>:  <span style="color:#ae81ff">9099</span>
          <span style="color:#66d9ef">name</span>:  saken-bluegreen
<span style="color:#75715e"># Service</span>
<span style="color:#66d9ef">apiVersion</span>: v1
<span style="color:#66d9ef">kind</span>: Service
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: saken-bluegreen-lb
  <span style="color:#66d9ef">namespace</span>: default
  <span style="color:#66d9ef">annotations</span>:
    <span style="color:#66d9ef">prometheus.io/path</span>: /metrics
    <span style="color:#66d9ef">prometheus.io/scrape</span>: <span style="color:#e6db74">&#34;true&#34;</span>
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">selector</span>:
    <span style="color:#66d9ef">app</span>: saken-bluegreen
  <span style="color:#66d9ef">type</span>: ClusterIP
  <span style="color:#66d9ef">sessionAffinity</span>: None
  <span style="color:#66d9ef">sessionAffinityConfig</span>:
    <span style="color:#66d9ef">clientIP</span>:
      <span style="color:#66d9ef">timeoutSeconds</span>: <span style="color:#ae81ff">10800</span>
  <span style="color:#66d9ef">ports</span>:
  - <span style="color:#66d9ef">name</span>: saken-bluegreen
    <span style="color:#66d9ef">protocol</span>: TCP
    <span style="color:#66d9ef">port</span>: <span style="color:#ae81ff">80</span>
    <span style="color:#66d9ef">targetPort</span>: <span style="color:#ae81ff">9099</span>
<span style="color:#75715e"># Preview-Service</span>
<span style="color:#66d9ef">apiVersion</span>: v1
<span style="color:#66d9ef">kind</span>: Service
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: saken-bluegreen-preview-lb
  <span style="color:#66d9ef">namespace</span>: default
  <span style="color:#66d9ef">annotations</span>:
    <span style="color:#66d9ef">prometheus.io/path</span>: /metrics
    <span style="color:#66d9ef">prometheus.io/scrape</span>: <span style="color:#e6db74">&#34;true&#34;</span>
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">selector</span>:
    <span style="color:#66d9ef">app</span>: saken-bluegreen
  <span style="color:#66d9ef">type</span>: ClusterIP
  <span style="color:#66d9ef">sessionAffinity</span>: None
  <span style="color:#66d9ef">sessionAffinityConfig</span>:
    <span style="color:#66d9ef">clientIP</span>:
      <span style="color:#66d9ef">timeoutSeconds</span>: <span style="color:#ae81ff">10800</span>
  <span style="color:#66d9ef">ports</span>:
  - <span style="color:#66d9ef">name</span>: saken-bluegreen
    <span style="color:#66d9ef">protocol</span>: TCP
    <span style="color:#66d9ef">port</span>: <span style="color:#ae81ff">80</span>
    <span style="color:#66d9ef">targetPort</span>: <span style="color:#ae81ff">9099</span>
<span style="color:#75715e"># AnalysisTemplate</span>
<span style="color:#66d9ef">apiVersion</span>: argoproj.io/v1alpha1
<span style="color:#66d9ef">kind</span>: AnalysisTemplate
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: bluegreen-smoke-test
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">args</span>:
  - <span style="color:#66d9ef">name</span>: service-name
  <span style="color:#66d9ef">metrics</span>:
  - <span style="color:#66d9ef">name</span>: bluegreen-smoke-test
    <span style="color:#66d9ef">provider</span>:
      <span style="color:#66d9ef">job</span>:
        <span style="color:#66d9ef">spec</span>:
          <span style="color:#66d9ef">backoffLimit</span>: <span style="color:#ae81ff">1</span>
          <span style="color:#66d9ef">template</span>:
            <span style="color:#66d9ef">spec</span>:
              <span style="color:#66d9ef">containers</span>:
              - <span style="color:#66d9ef">name</span>: bluegreen-smoke-test
                <span style="color:#66d9ef">image</span>: alpine
                <span style="color:#66d9ef">command</span>: 
                - /bin/sh
                - -c
                - <span style="color:#e6db74">|
</span><span style="color:#e6db74">                - echo &#34;mock smoke test to serivce ...&#34;</span>
              <span style="color:#66d9ef">restartPolicy</span>: Never
<span style="color:#75715e"># Kustomization</span>
<span style="color:#66d9ef">apiVersion</span>: kustomize.config.k8s.io/v1beta1
<span style="color:#66d9ef">kind</span>: Kustomization
<span style="color:#66d9ef">resources</span>:
- ../../base
- bluegreen-rollout.yaml
- bluegreen-service.yaml
- bluegreen-service-preview.yaml
- bluegreen-smoke-test.yaml

<span style="color:#66d9ef">namespace</span>: staging
<span style="color:#66d9ef">images</span>:
- <span style="color:#66d9ef">name</span>: ccr.ccs.tencentyun.com/shovel/shovel-rollouts
  <span style="color:#66d9ef">newTag</span>: <span style="color:#ae81ff">0.0.2</span>
</code></pre></div><h3 id="é¡¹ç›®æºç ">é¡¹ç›®æºç </h3>
<p>å¯ä»¥åœ¨Githubä¸Šè·å–åˆ°æ­¤é¡¹ç›®çš„æºç ï¼š<a href="https://github.com/ChinaLHR/shovel-progressive-delivery-argo-rollouts">https://github.com/ChinaLHR/shovel-progressive-delivery-argo-rollouts</a></p>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li><a href="https://argoproj.github.io/argo-rollouts/">https://argoproj.github.io/argo-rollouts/</a></li>
<li><a href="https://github.com/argoproj/rollouts-demo">https://github.com/argoproj/rollouts-demo</a></li>
<li><a href="https://kubernetes.io/zh-cn/docs/concepts/workloads/">https://kubernetes.io/zh-cn/docs/concepts/workloads/</a></li>
</ul>
        </p>
    </div>
</div>

<aside class="post-toc">
    <nav id="toc">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#å…³äºæ¸è¿›å¼äº¤ä»˜">å…³äºæ¸è¿›å¼äº¤ä»˜</a>
          <ul>
            <li><a href="#ä»€ä¹ˆæ˜¯æ¸è¿›å¼äº¤ä»˜">ä»€ä¹ˆæ˜¯æ¸è¿›å¼äº¤ä»˜</a></li>
            <li><a href="#æ¸è¿›å¼äº¤ä»˜éƒ¨ç½²ç­–ç•¥">æ¸è¿›å¼äº¤ä»˜éƒ¨ç½²ç­–ç•¥</a>
              <ul>
                <li><a href="#blue-green-deploymentsè“ç»¿éƒ¨ç½²">Blue-green Deploymentsï¼ˆè“ç»¿éƒ¨ç½²ï¼‰</a></li>
                <li><a href="#canary-releasesé‡‘ä¸é›€å‘å¸ƒ">Canary Releasesï¼ˆé‡‘ä¸é›€å‘å¸ƒï¼‰</a></li>
                <li><a href="#ab-testing">A/B Testing</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#æ¸è¿›å¼äº¤ä»˜ä¸kubernetes-workloads">æ¸è¿›å¼äº¤ä»˜ä¸Kubernetes Workloads</a></li>
        <li><a href="#argo-rollouts">Argo Rollouts</a>
          <ul>
            <li><a href="#argo-rolloutsæ¦‚è¿°">Argo Rolloutsæ¦‚è¿°</a></li>
            <li><a href="#argo-rollouts-æ¶æ„">Argo Rollouts æ¶æ„</a></li>
            <li><a href="#å®‰è£…argo-rollouts">å®‰è£…Argo Rollouts</a></li>
          </ul>
        </li>
        <li><a href="#åŸºäºargo-rolloutsçš„æ¸è¿›å¼äº¤ä»˜å®è·µ">åŸºäºArgo Rolloutsçš„æ¸è¿›å¼äº¤ä»˜å®è·µ</a>
          <ul>
            <li><a href="#åŸºæœ¬ä½¿ç”¨">åŸºæœ¬ä½¿ç”¨</a></li>
            <li><a href="#argo-rollout-analysis">Argo Rollout Analysis</a></li>
            <li><a href="#canary-analysisé‡‘ä¸é›€åˆ†æ">Canary-Analysis(é‡‘ä¸é›€åˆ†æ)</a></li>
            <li><a href="#blue-green-analysisè“ç»¿åˆ†æ">Blue-Green-Analysis(è“ç»¿åˆ†æ)</a></li>
            <li><a href="#é¡¹ç›®æºç ">é¡¹ç›®æºç </a></li>
          </ul>
        </li>
        <li><a href="#å‚è€ƒ">å‚è€ƒ</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </nav>
</aside>



    

        </main><footer class="footer">
    <span>&copy; 2023 hanrong.li</span>
    <span>
        Made with &#10084;&#65039; using <a target="_blank" href="https://github.com/526avijitgupta/gokarna">Gokarna</a>
    </span>
</footer>
</body>
</html>
