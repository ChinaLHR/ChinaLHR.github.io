<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #FF4D4D;
        }
    </style>

    
    
    
    
    
    

    
    <title>AspectåŠ¨æ€Pointcutå®ç°æ–¹æ¡ˆ</title>
    <meta name="description" content="keep curious ğŸ˜¼">
    <meta name="keywords" content='blog, chinalhr, lhr, java, spring framework'>

    <meta property="og:url" content="https://chinalhr.github.io/post/aspect-dynamic/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="AspectåŠ¨æ€Pointcutå®ç°æ–¹æ¡ˆ">
    <meta property="og:description" content="keep curious ğŸ˜¼">
    <meta property="og:image" content="https://user-images.githubusercontent.com/19829495/188320707-5b468cc9-bea4-486c-b591-57ff8324e41c.jpg">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="AspectåŠ¨æ€Pointcutå®ç°æ–¹æ¡ˆ">
    <meta name="twitter:description" content="keep curious ğŸ˜¼">
    <meta property="twitter:domain" content="https://chinalhr.github.io/post/aspect-dynamic/">
    <meta property="twitter:url" content="https://chinalhr.github.io/post/aspect-dynamic/">
    <meta name="twitter:image" content="https://user-images.githubusercontent.com/19829495/188320707-5b468cc9-bea4-486c-b591-57ff8324e41c.jpg">

    
    <link rel="canonical" href="https://chinalhr.github.io/post/aspect-dynamic/" />

    <link rel="stylesheet" type="text/css" href="https://chinalhr.github.io//css/normalize.min.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" type="text/css" href="https://chinalhr.github.io//css/main.css">
    <link disabled id="dark-theme" rel="stylesheet" href="https://chinalhr.github.io//css/dark.css">

    <script src="https://chinalhr.github.io//js/svg-injector.min.js"></script>
    <script src="https://chinalhr.github.io//js/feather-icons.min.js"></script>
    <script src="https://chinalhr.github.io//js/main.js"></script>

    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JLJBQBW5WM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-JLJBQBW5WM');
</script>
  
    
    
    

    
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css">
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">

        
        <div class="avatar">
            <a href="https://chinalhr.github.io/">
                <img src="https://user-images.githubusercontent.com/19829495/188320707-5b468cc9-bea4-486c-b591-57ff8324e41c.jpg" alt="avatar" />
            </a>
        </div>
        

        <div class="nav-title">
            <a class="nav-brand" href="https://chinalhr.github.io/">LHR</a>
        </div>

        <div class="nav-links">
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/" aria-label="Jump to a specific link"><span data-feather='home'></span> Home </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/post/" aria-label="Jump to a specific link"><span data-feather='book'></span> Posts </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/tags/" aria-label="Jump to a specific link"><span data-feather='tag'></span> Tags </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/projects/" aria-label="Jump to a specific link"><span data-feather='code'></span> Projects </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/about/" aria-label="Jump to a specific link"><span data-feather='user'></span> About </a>
            </div>
            
            <div class="nav-link">
                <a href="https://github.com/chinalhr" aria-label="Jump to a specific link"><span data-feather='github'></span>  </a>
            </div>
            
            <div class="nav-link">
                <a href="https://chinalhr.github.io/index.xml" aria-label="Jump to a specific link"><span data-feather='rss'></span>  </a>
            </div>
            

            <span class="nav-icons-divider"></span>
            <div class="nav-link dark-theme-toggle">
                <span id="dark-theme-toggle-screen-reader-target" class="sr-only"></span>
                <a>
                    <span id="theme-toggle-icon" data-feather="moon"></span>
                </a>
            </div>

            <div class="nav-link" id="hamburger-menu-toggle">
                <span id="hamburger-menu-toggle-screen-reader-target" class="sr-only">menu</span>
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/" aria-label="Jump to a specific link"><span data-feather='home'></span> Home </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/post/" aria-label="Jump to a specific link"><span data-feather='book'></span> Posts </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/tags/" aria-label="Jump to a specific link"><span data-feather='tag'></span> Tags </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/projects/" aria-label="Jump to a specific link"><span data-feather='code'></span> Projects </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/about/" aria-label="Jump to a specific link"><span data-feather='user'></span> About </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://github.com/chinalhr" aria-label="Jump to a specific link"><span data-feather='github'></span>  </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://chinalhr.github.io/index.xml" aria-label="Jump to a specific link"><span data-feather='rss'></span>  </a>
                </li>
                
                <li class="nav-item dark-theme-toggle">
                    <span id="dark-theme-toggle-screen-reader-target" class="sr-only">theme</span>
                    <a>
                        <span id="theme-toggle-icon" data-feather="moon"></span>
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</header>
<main id="content">
    <div class="post container">
    <div class="post-header-section">
        <h1>AspectåŠ¨æ€Pointcutå®ç°æ–¹æ¡ˆ</h1>
        <small role="doc-subtitle"></small>
        <p class="post-date">
            April 18, 2019
        </p>

        <ul class="post-tags">
        
            <li class="post-tag"><a href="https://chinalhr.github.io/tags/java">java</a></li>
        
            <li class="post-tag"><a href="https://chinalhr.github.io/tags/spring-framework">spring framework</a></li>
        
        </ul>
    </div>

    <div class="post-content">
        <p>
            <blockquote>
<p>Spriing Aopä¸­åŠ¨æ€Pointcutçš„å®è·µ</p>
</blockquote>
<h4 id="ä¸ºä»€ä¹ˆéœ€è¦aspectjä¸­å…·æœ‰åŠ¨æ€å€¼çš„pointcut">ä¸ºä»€ä¹ˆéœ€è¦AspectJä¸­å…·æœ‰åŠ¨æ€å€¼çš„Pointcut</h4>
<p>å·¥ä½œä¸­éœ€è¦æŠ½ç¦»å‡ºå…¬å¸é¡¹ç›®çš„ä¸€äº›ç›‘æ§ç»„ä»¶æ‰“æˆä¸€ä¸ªå…¬å…±åŒ…,éœ€è¦å¯¹ä¸€äº›Aspectä½œåŠ¨æ€é€‚é…(æ ¹æ®å¼•å…¥é¡¹ç›®çš„ComponentScanè¿›è¡Œç‰¹å®špackageçš„Pointcut/é…ç½®PointCut)</p>
<h4 id="pointcutçš„ç”¨æ³•">@Pointcutçš„ç”¨æ³•</h4>
<ul>
<li>æ ¼å¼</li>
</ul>
<pre><code>execution(modifiers-pattern? ret-type-pattern declaring-type-pattern? name-pattern(param-pattern)throws-pattern?) 

ä¿®é¥°ç¬¦åŒ¹é…ï¼ˆmodifier-pattern?ï¼‰
è¿”å›å€¼åŒ¹é…ï¼ˆret-type-patternï¼‰å¯ä»¥ä¸º*è¡¨ç¤ºä»»ä½•è¿”å›å€¼,å…¨è·¯å¾„çš„ç±»åç­‰
ç±»è·¯å¾„åŒ¹é…ï¼ˆdeclaring-type-pattern?ï¼‰
æ–¹æ³•ååŒ¹é…ï¼ˆname-patternï¼‰å¯ä»¥æŒ‡å®šæ–¹æ³•å æˆ–è€… *ä»£è¡¨æ‰€æœ‰, set* ä»£è¡¨ä»¥setå¼€å¤´çš„æ‰€æœ‰æ–¹æ³•
å‚æ•°åŒ¹é…ï¼ˆ(param-pattern)ï¼‰å¯ä»¥æŒ‡å®šå…·ä½“çš„å‚æ•°ç±»å‹ï¼Œå¤šä¸ªå‚æ•°é—´ç”¨â€œ,â€éš”å¼€ï¼Œå„ä¸ªå‚æ•°ä¹Ÿå¯ä»¥ç”¨â€œ*â€æ¥è¡¨ç¤ºåŒ¹é…ä»»æ„ç±»å‹çš„å‚æ•°ï¼Œå¦‚(String)è¡¨ç¤ºåŒ¹é…ä¸€ä¸ªStringå‚æ•°çš„æ–¹æ³•ï¼›(*,String) è¡¨ç¤ºåŒ¹é…æœ‰ä¸¤ä¸ªå‚æ•°çš„æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œè€Œç¬¬äºŒä¸ªå‚æ•°æ˜¯Stringç±»å‹ï¼›å¯ä»¥ç”¨(..)è¡¨ç¤ºé›¶ä¸ªæˆ–å¤šä¸ªä»»æ„å‚æ•°
å¼‚å¸¸ç±»å‹åŒ¹é…ï¼ˆthrows-pattern?ï¼‰
å…¶ä¸­åé¢è·Ÿç€â€œ?â€çš„æ˜¯å¯é€‰é¡¹

1ï¼‰execution(* *(..))  
//è¡¨ç¤ºåŒ¹é…æ‰€æœ‰æ–¹æ³•  
2ï¼‰execution(public * com. savage.service.UserService.*(..))  
//è¡¨ç¤ºåŒ¹é…com.savage.server.UserServiceä¸­æ‰€æœ‰çš„å…¬æœ‰æ–¹æ³•  
3ï¼‰execution(* com.savage.server..*.*(..))  
//è¡¨ç¤ºåŒ¹é…com.savage.serveråŒ…åŠå…¶å­åŒ…ä¸‹çš„æ‰€æœ‰æ–¹æ³• 
</code></pre><ul>
<li>Springä¸­çš„Pointcut(Pointcutè¡¨ç¤ºå¼(expression)å’ŒPointcutç­¾å(signature))</li>
</ul>
<pre><code>//Pointcutè¡¨ç¤ºå¼(å¯ä»¥ä½¿ç”¨&amp;&amp; || ! è¿™ä¸‰ä¸ªè¿ç®—)
@Pointcut(&quot;execution(* com.savage.aop.MessageSender.*(..))&quot;)
//Pointç­¾å
private void log(){} 
</code></pre><h4 id="javassistå®ç°åŠ¨æ€pointcut">javassistå®ç°åŠ¨æ€Pointcut</h4>
<ul>
<li>å…³äºSpringAop</li>
</ul>
<p>AspectJæ–¹å¼ç»‡å…¥çš„æ ¸å¿ƒï¼Œæ˜¯ä¸€ä¸ªBeanPostProcessï¼ˆä¼šæ‰«ææ‰€æœ‰çš„Pointcutä¸éå†æ‰€æœ‰Bean,å¹¶å¯¹éœ€è¦çš„Beanè¿›è¡Œç»‡å…¥-è‡ªåŠ¨ä»£ç†ï¼Œå½“å¯¹è±¡å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œä¸ºå…¶ç”Ÿæˆä»£ç†å¯¹è±¡å¹¶è¿”å›ï¼‰</p>
<ul>
<li>æ€è·¯</li>
</ul>
<p>åœ¨Aopçš„BeanPostProcessæ‰§è¡Œä¹‹å‰( springApplication.runä¹‹å‰),ä½¿ç”¨javassistä¿®æ”¹ç›®æ ‡Aopç±»å­—èŠ‚ç ï¼ŒåŠ¨æ€è®¾ç½®@Pointcut,è®¾ç½® valueä¸ºæˆ‘ä»¬è‡ªå·±åŠ¨æ€æŸ¥è¯¢åˆ°çš„å€¼ã€‚</p>
<ul>
<li>å…¶ä»–</li>
</ul>
<p>ç”±äºSpring bootçš„ç±»åŠ è½½æœºåˆ¶ï¼Œè¿è¡Œæ—¶javassistä¼šæ‰«æä¸åˆ°åŒ…ï¼Œè¦é€šè¿‡insertClassPathæ·»åŠ æ‰«æè·¯å¾„</p>
<p>ä¿®æ”¹@Pointcutçš„åˆ‡ç‚¹å€¼åï¼Œé€šè¿‡toClassè¦†ç›–åŸæœ‰ç±»ï¼Œéœ€è¦é€šè¿‡ç±»åŠ è½½å™¨é‡æ–°åŠ è½½ã€‚</p>
<ul>
<li>å®ç°</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@SpringBootApplication</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UidServerApplication</span> <span style="color:#66d9ef">extends</span> SpringBootServletInitializer <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        AspectPoincutScan<span style="color:#f92672">();</span>
        SpringApplication springApplication <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SpringApplication<span style="color:#f92672">(</span>UidServerApplication<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
        springApplication<span style="color:#f92672">.</span><span style="color:#a6e22e">addInitializers</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> UidApplicationContextInitializer<span style="color:#f92672">());</span>
        springApplication<span style="color:#f92672">.</span><span style="color:#a6e22e">run</span><span style="color:#f92672">(</span>args<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">protected</span> SpringApplicationBuilder <span style="color:#a6e22e">configure</span><span style="color:#f92672">(</span>
            SpringApplicationBuilder builder<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        AspectPoincutScan<span style="color:#f92672">();</span>
        <span style="color:#66d9ef">return</span> builder<span style="color:#f92672">.</span><span style="color:#a6e22e">sources</span><span style="color:#f92672">(</span>UidServerApplication<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">initializers</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> UidApplicationContextInitializer<span style="color:#f92672">())</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">listeners</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> UidApplicationRefreshedListener<span style="color:#f92672">())</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">listeners</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> UidApplicationCloseListener<span style="color:#f92672">());</span>
    <span style="color:#f92672">}</span>


    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">AspectPoincutScan</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            ClassPool pool <span style="color:#f92672">=</span> ClassPool<span style="color:#f92672">.</span><span style="color:#a6e22e">getDefault</span><span style="color:#f92672">();</span>
            <span style="color:#75715e">// æ·»åŠ åŒ…çš„æ‰«æè·¯å¾„
</span><span style="color:#75715e"></span>            ClassClassPath classPath <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ClassClassPath<span style="color:#f92672">(</span>UidServerApplication<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
            pool<span style="color:#f92672">.</span><span style="color:#a6e22e">insertClassPath</span><span style="color:#f92672">(</span>classPath<span style="color:#f92672">);</span>
            <span style="color:#75715e">//è·å–è¦ä¿®æ”¹çš„Class
</span><span style="color:#75715e"></span>            CtClass ct <span style="color:#f92672">=</span> pool<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;mobi.meishuo.uidserver.monitor.springaop.ServiceMonitorAop&#34;</span><span style="color:#f92672">);</span>
            CtMethod<span style="color:#f92672">[]</span> cms <span style="color:#f92672">=</span> ct<span style="color:#f92672">.</span><span style="color:#a6e22e">getDeclaredMethods</span><span style="color:#f92672">();</span>
            <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>CtMethod cm <span style="color:#f92672">:</span> cms<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#75715e">//æ‰¾åˆ°@pointcut æ³¨è§£çš„æ–¹æ³•
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>cm<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">().</span><span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;pointcut&#34;</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>

                    MethodInfo methodInfo <span style="color:#f92672">=</span> cm<span style="color:#f92672">.</span><span style="color:#a6e22e">getMethodInfo</span><span style="color:#f92672">();</span>
                    ConstPool cPool <span style="color:#f92672">=</span> methodInfo<span style="color:#f92672">.</span><span style="color:#a6e22e">getConstPool</span><span style="color:#f92672">();</span>

                    AnnotationsAttribute attribute <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> AnnotationsAttribute<span style="color:#f92672">(</span>cPool<span style="color:#f92672">,</span> AnnotationsAttribute<span style="color:#f92672">.</span><span style="color:#a6e22e">visibleTag</span><span style="color:#f92672">);</span>
                    <span style="color:#75715e">//è·å–@pointcut æ³¨è§£ï¼Œä¿®æ”¹å…¶valueå€¼
</span><span style="color:#75715e"></span>                    Annotation annotation <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Annotation<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;org.aspectj.lang.annotation.Pointcut&#34;</span><span style="color:#f92672">,</span> cPool<span style="color:#f92672">);</span>
                    annotation<span style="color:#f92672">.</span><span style="color:#a6e22e">addMemberValue</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> StringMemberValue<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;execution(xxxx&#34;</span><span style="color:#f92672">,</span> cPool<span style="color:#f92672">));</span>
                    attribute<span style="color:#f92672">.</span><span style="color:#a6e22e">setAnnotation</span><span style="color:#f92672">(</span>annotation<span style="color:#f92672">);</span>
                    methodInfo<span style="color:#f92672">.</span><span style="color:#a6e22e">addAttribute</span><span style="color:#f92672">(</span>attribute<span style="color:#f92672">);</span>

                    <span style="color:#75715e">//è¦†ç›–åŸæœ‰ç±»
</span><span style="color:#75715e"></span>                    ct<span style="color:#f92672">.</span><span style="color:#a6e22e">toClass</span><span style="color:#f92672">();</span>
                    <span style="color:#75715e">//ä½¿ç”¨ç±»åŠ è½½å™¨é‡æ–°åŠ è½½Aopç±»
</span><span style="color:#75715e"></span>                    pool<span style="color:#f92672">.</span><span style="color:#a6e22e">getClassLoader</span><span style="color:#f92672">().</span><span style="color:#a6e22e">loadClass</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;mobi.meishuo.uidserver.monitor.springaop.ServiceMonitorAop&#34;</span><span style="color:#f92672">);</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>

<span style="color:#f92672">}</span>
</code></pre></div><h4 id="ç¼–ç¨‹å¼aopå®ç°åŠ¨æ€pointcut">ç¼–ç¨‹å¼AOPå®ç°åŠ¨æ€PointCut</h4>
<ul>
<li>PonitCut</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Pointcut <span style="color:#a6e22e">getAdapterServicePointcut</span><span style="color:#f92672">(){</span>
        AspectJExpressionPointcut adapterPointcut <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> AspectJExpressionPointcut<span style="color:#f92672">();</span>
        <span style="color:#75715e">//ä»é…ç½®æ–‡ä»¶ä¸­è·å–PointCutè¡¨è¾¾å¼
</span><span style="color:#75715e"></span>        adapterPointcut<span style="color:#f92672">.</span><span style="color:#a6e22e">setExpression</span><span style="color:#f92672">(</span>MonitorPropertyConfig<span style="color:#f92672">.</span><span style="color:#a6e22e">getPoinitcutAdapter</span><span style="color:#f92672">());</span>
        <span style="color:#66d9ef">return</span> adapterPointcut<span style="color:#f92672">;}</span>
        
<span style="color:#75715e">//æ‰©å±•Springä¸­AbstractBeanFactoryPointcutAdvisor
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AdapterServiceAdvisor</span> <span style="color:#66d9ef">extends</span> AbstractBeanFactoryPointcutAdvisor <span style="color:#f92672">{</span>

    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> Pointcut <span style="color:#a6e22e">getPointcut</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> getAdapterServicePointcut<span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>

<span style="color:#f92672">}</span>
</code></pre></div><ul>
<li>Advice</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AdapterServiceMonitorInterceptor</span> <span style="color:#66d9ef">implements</span> MethodInterceptor <span style="color:#f92672">{</span>

    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> Object <span style="color:#a6e22e">invoke</span><span style="color:#f92672">(</span>MethodInvocation invocation<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Throwable <span style="color:#f92672">{</span>
       <span style="color:#75715e">//åšä¸€äº›æ“ä½œ...
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><ul>
<li>é…ç½®Advisor Bean</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Configuration</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MonitorProxyConfiguration</span> <span style="color:#f92672">{</span>

    <span style="color:#a6e22e">@Bean</span><span style="color:#f92672">(</span>name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;adapterServiceAdvisor&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#a6e22e">@Role</span><span style="color:#f92672">(</span>BeanDefinition<span style="color:#f92672">.</span><span style="color:#a6e22e">ROLE_INFRASTRUCTURE</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">public</span> AdapterServiceAdvisor <span style="color:#a6e22e">adapterServiceAdvisor</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        AdapterServiceAdvisor advisor <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> AdapterServiceAdvisor<span style="color:#f92672">();</span>
        advisor<span style="color:#f92672">.</span><span style="color:#a6e22e">setAdviceBeanName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;adapterServiceAdvice&#34;</span><span style="color:#f92672">);</span>
        advisor<span style="color:#f92672">.</span><span style="color:#a6e22e">setAdvice</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> AdapterServiceMonitorInterceptor<span style="color:#f92672">());</span>
        advisor<span style="color:#f92672">.</span><span style="color:#a6e22e">setOrder</span><span style="color:#f92672">(</span>Ordered<span style="color:#f92672">.</span><span style="color:#a6e22e">HIGHEST_PRECEDENCE</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">return</span> advisor<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div>
        </p>
    </div>
</div>

<aside class="post-toc">
    <nav id="toc">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li>
              <ul>
                <li><a href="#ä¸ºä»€ä¹ˆéœ€è¦aspectjä¸­å…·æœ‰åŠ¨æ€å€¼çš„pointcut">ä¸ºä»€ä¹ˆéœ€è¦AspectJä¸­å…·æœ‰åŠ¨æ€å€¼çš„Pointcut</a></li>
                <li><a href="#pointcutçš„ç”¨æ³•">@Pointcutçš„ç”¨æ³•</a></li>
                <li><a href="#javassistå®ç°åŠ¨æ€pointcut">javassistå®ç°åŠ¨æ€Pointcut</a></li>
                <li><a href="#ç¼–ç¨‹å¼aopå®ç°åŠ¨æ€pointcut">ç¼–ç¨‹å¼AOPå®ç°åŠ¨æ€PointCut</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
    </nav>
</aside>



    

        </main><footer class="footer">
    <span>&copy; 2025 hanrong.li</span>
    <span>
        Made with &#10084;&#65039; using <a target="_blank" href="https://github.com/526avijitgupta/gokarna">Gokarna</a>
    </span>
</footer>
</body>
</html>
