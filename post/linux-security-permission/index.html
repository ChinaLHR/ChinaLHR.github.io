<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<title>Linux用户-权限</title>


  




<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link
  rel="alternate"
  type="application/rss+xml"
  href="https://chinalhr.github.io/index.xml"
  title="ChinaLHR Blog"
/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Linux用户-权限"/>
<meta name="twitter:description" content="
读《Linux命令行与shell脚本编程大全》记录
"/>



<link rel="stylesheet" href="https://chinalhr.github.io/fontawesome/css/all.min.css" />




<link
  crossorigin="anonymous"
  href="/css/styles.min.css"
  integrity=""
  rel="preload stylesheet"
  as="style"
/>




<link
  id="dark-mode-theme"
  crossorigin="anonymous"
  href="/css/dark.min.css"
  integrity=""
  rel="preload stylesheet"
  as="style"
/>


<script>
  var darkTheme = document.getElementById('dark-mode-theme')
  var storedTheme = localStorage.getItem('dark-mode-storage')

  if (storedTheme === 'dark') {
    darkTheme.disabled = false
  } else if (storedTheme === 'light') {
    darkTheme.disabled = true
  }
</script>


<script defer crossorigin="anonymous" src="/js/theme.js" integrity=""></script>


<script defer crossorigin="anonymous" src="/js/instantpage.min.js" integrity=""></script><meta name="generator" content="Hugo 0.68.3" />
  </head>
  <body>
    
  




  <header>
    <nav class="navbar">
  <div class="nav">
    
      <a href="https://chinalhr.github.io/" class="nav-logo">
        <img
          src="https://chinalhr.github.io/images/icon.png"
          width="50"
          height="50"
          alt="Logo"
        />
      </a>
    

    <ul class="nav-links">
      
        
          <li>
            <a href="/about/" id="About"
              ><em class="fas fa-user fa-lg"></em
            ></a>
          </li>
          
      
        
          <li>
            <a href="/categories/" id="Categories"
              ><em class="fas fa-filter fa-lg"></em
            ></a>
          </li>
          
      
        
          <li>
            <a href="/tags/" id="Tags"
              ><em class="fas fa-tags fa-lg"></em
            ></a>
          </li>
          
      
        
          <li>
            <a href="/archives/" id="Archives"
              ><em class="fas fa-archive fa-lg"></em
            ></a>
          </li>
          
      
        
          <li>
            <a href="/search/" id="Search"
              ><em class="fas fa-search fa-lg"></em
            ></a>
          </li>
          
      
    </ul>
  </div>
</nav>

    <div class="intro-header">
      <div class="container">
        <div class="post-heading">
          
            <h1>
              Linux用户-权限
            </h1>
          
          
            <span class="meta-post">
  <em class="fa fa-calendar-alt"></em
  >&nbsp;Oct 23, 2019
  
    &nbsp;&nbsp;&nbsp;<em class="fa fa-folder-open"></em>&nbsp;
    
      <a
        href="https://chinalhr.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"
        >操作系统</a
      >&nbsp;
    
  
</span>

          
        </div>
      </div>
    </div>
  </header>
  

    
  <div class="container" role="main">
    <article class="article" class="blog-post">
      <blockquote>
<p>读《Linux命令行与shell脚本编程大全》记录</p>
</blockquote>
<h3 id="安全性">安全性</h3>
<ul>
<li>/etc/passwd</li>
</ul>
<p>Linux系统使用/etc/passwd文件来将用户的登录名匹配到对应的UID值。root管理员账户固定分配给它的UID是0。</p>
<p>/etc/passwd包含的信息</p>
<pre><code>登录用户名
用户密码（x显示）
用户账户的UID（数字形式）
用户账户的组ID（GID）（数字形式）
用户账户的文本描述（称为备注字段）
用户HOME目录的位置
用户的默认shell

例如
root:x:0:0:root:/root:/bin/bash
</code></pre><ul>
<li>/etc/shadow</li>
</ul>
<p>Linux系统使用/etc/shadow文件对Linux系统密码管理提供了更多的控制。只有root用户才能访问/etc/shadow文件。</p>
<p>/etc/shadow包含的信息</p>
<pre><code>与/etc/passwd文件中的登录名字段对应的登录名
加密后的密码
自上次修改密码后过去的天数密码（自1970年1月1日开始计算）
多少天后才能更改密码
多少天后必须更改密码
密码过期前提前多少天提醒用户更改密码
密码过期后多少天禁用用户账户
用户账户被禁用的日期（用自1970年1月1日到当天的天数表示）
预留字段给将来使用

例如
rich:$1$.FfcK0ns$f1UgiyHQ25wrB/hykCn020:11627:0:99999:7:::
</code></pre><h3 id="用户">用户</h3>
<h4 id="添加用户">添加用户</h4>
<pre><code>useradd [选项][用户名]

-c comment 给新用户添加备注
-d home_dir 为主目录指定一个名字（如果不想用登录名作为主目录名的话）
-e expire_date 用YYYY-MM-DD格式指定一个账户过期的日期
-f inactive_days 指定这个账户密码过期后多少天这个账户被禁用； 0表示密码一过期就立即禁用， 1表示
禁用这个功能
-g initial_group 指定用户登录组的GID或组名
-G group ... 指定用户除登录组之外所属的一个或多个附加组
-k 必须和-m一起使用，将/etc/skel目录的内容复制到用户的HOME目录
-m 创建用户的HOME目录
-M 不创建用户的HOME目录（当默认设置里要求创建时才使用这个选项）
-n 创建一个与用户登录名同名的新组
-r 创建系统账户
-p passwd 为用户账户指定默认密码
-s shell 指定默认的登录shell
-u uid 为账户指定唯一的UID'

# 更改默认参数
-b default_home 更改默认的创建用户HOME目录的位置
-e expiration_date 更改默认的新账户的过期日期
-f inactive 更改默认的新用户从密码过期到账户被禁用的天数
-g group 更改默认的组名称或GID
-s shell 更改默认的登录shell

useradd -m test
</code></pre><p>在创建新用户时，如果你不在命令行中指定具体的值， useradd命令就会使用-D选项所显示的那些默认值。</p>
<h4 id="删除用户">删除用户</h4>
<pre><code>userdel [选项][用户名]

-r 把用户的主目录一起删除
</code></pre><h4 id="修改用户">修改用户</h4>
<p>linux提供了修改已有用户账户信息的工具。</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>usermod</td>
<td>修改用户账户的字段，还可以指定主要组以及附加组的所属关系</td>
</tr>
<tr>
<td>passwd</td>
<td>修改已有用户的密码</td>
</tr>
<tr>
<td>chpasswd</td>
<td>从文件中读取登录名密码对，并更新密码</td>
</tr>
<tr>
<td>chage</td>
<td>修改密码的过期日期</td>
</tr>
<tr>
<td>chfn</td>
<td>修改用户账户的备注信息</td>
</tr>
<tr>
<td>chsh</td>
<td>修改用户账户的默认登录shell</td>
</tr>
</tbody>
</table>
<p>usermod用来修改/etc/passwd文件中的大部分字段</p>
<pre><code>usermod[选项][用户名]

参数参考useradd，新增改为修改
-l修改用户账户的登录名。
-L锁定账户，使用户无法登录。
-p修改账户的密码。
-U解除锁定，使用户能够登录
</code></pre><p>passwd</p>
<pre><code>passwd [选项][用户名]

-l 锁定口令，即禁用账号。
-u 口令解锁。
-d 使账号无口令。
-f 强迫用户下次登录时修改口令。

# 修改test用户的密码
passwd test

New password:******* 
Re-enter new password:*******
</code></pre><h3 id="用户组">用户组</h3>
<p>组权限允许多个用户对系统中的对象（比如文件、目录或设备等）共享一组共用的权限。</p>
<p>/etc/group文件包含系统上用到的每个组的信息。</p>
<pre><code>组名:组密码:GID:属于该组的用户列表

root:x:0:root
bin:x:1:root,bin,daemon
daemon:x:2:root,bin,daemon
sys:x:3:root,bin,adm
adm:x:4:root,adm,daemon
rich:x:500:
mama:x:501:
katie:x:502:
jessica:x:503:
mysql:x:27:
test:x:504:
</code></pre><h4 id="创建组">创建组</h4>
<pre><code>groupadd[选项][用户组]

-g GID 指定新用户组的组标识号（GID）。
-o 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同。

# 创建组test
groupadd test
# usermod将用户添加进组
usermod -G test lhr
</code></pre><h4 id="修改组">修改组</h4>
<pre><code>groupmod[选项][用户组]

-g 修改已有组的GID
-n 修改已有组的组名

# 修改 test 组为 tester
groupmod -n tester test
</code></pre><h4 id="删除组">删除组</h4>
<pre><code>groupdel[用户组]
groupdel test
</code></pre><h3 id="权限">权限</h3>
<h4 id="文件权限符">文件权限符</h4>
<pre><code>drwxrwxr-x 2 rich rich 4096 2010-09-03 15:12 test1

第一个字符代表了对象的类型:
-代表文件
d代表目录
l代表链接
c代表字符型设备
b代表块设备
n代表网络设备

后面3组三字符的编码，定义了3种访问权
r代表对象是可读的
w代表对象是可写的
x代表对象是可执行的

3组权限分别对应对象的3个安全级别
</code></pre><p><img src="https://user-images.githubusercontent.com/19829495/67378468-e0c0d700-f5b9-11e9-8f08-3c504221f382.png" alt="image"></p>
<h4 id="权限掩码">权限掩码</h4>
<p>八进制模式的安全性设置先获取这3个rwx权限的值，然后将其转换成3位二进制值，用一个八进制值来表示。在这个二进制表示中，每个位置代表一个二进制位。因此，如果读权限是唯一
置位的权限，权限值就是r&ndash;，转换成二进制值就是100，代表的八进制值是4。</p>
<p><img src="https://user-images.githubusercontent.com/19829495/67382680-765f6500-f5c0-11e9-9751-e7e04c3d6489.png" alt="image"></p>
<ul>
<li>umask指定在建立文件时预设的权限掩码</li>
</ul>
<pre><code>umask [-S][权限掩码]
</code></pre><h4 id="更改权限">更改权限</h4>
<ul>
<li>命令</li>
</ul>
<pre><code>chmod options mode file

# 通过权限掩码更改权限
chmod 760 newfile

# 通过符号模式更改权限
[ugoa…][+-=][rwxXstugo…]

[ugoa…]u代表用户g代表组o代表其他a代表上述所有
[+-=]在现有权限基础上增加/减少权限
[rwxXstugo…]
X:如果对象是目录或者它已有执行权限，赋予执行权限。
s：运行时重新设置UID或GID。
t：保留文件或目录。
u：将权限设置为跟属主一样。
g：将权限设置为跟属组一样。
o：将权限设置为跟其他用户一样

chmod o+r newfile
</code></pre><h4 id="更改所属关系">更改所属关系</h4>
<p>chown命令用来改变文件的属主，chgrp命令用来改变文件的默认属组。</p>
<pre><code>chown options owner[.group] file

# 改变文件属主为dan
chown dan newfile
# 改变文件的默认属组为tester
chgrp tester newfile
</code></pre>


      
        <div class="blog-tags">
          
            <a
              href="https://chinalhr.github.io/tags/linux/"
              >Linux</a
            >&nbsp;
          
        </div>
      
    </article>
    
      <script>
  document.addEventListener('scroll', function () {
    if (
      document.body.scrollTop > 50 ||
      document.documentElement.scrollTop > 50
    ) {
      document.getElementById('backtotopButton').style.opacity = '1'
      document.getElementById('backtotopButton').style.transition = '0.5s'
    } else {
      document.getElementById('backtotopButton').style.opacity = '0'
      document.getElementById('backtotopButton').style.transition = '0.5s'
    }
  })

  function topFunction() {
    document.body.scrollTop = 0 
    document.documentElement.scrollTop = 0 
  }
</script>

      <button onclick="topFunction()" id="backtotopButton">
        <em class="fa fa-angle-up"></em>
      </button>
    
    
      

    
  </div>

    <footer>
  

<div class="social-icons">
  
    
    
      
      <a href="https://github.com/chinalhr" name="GitHub">
        <em class="fab fa-github"></em>
      </a>
    
       &nbsp;&ndash;&nbsp;
      <a href="mailto:13435500980@163.com" name="Email">
        <em class="fas fa-envelope"></em>
      </a>
    
  

  
</div>


  
  <div class="container">
    <p class="credits copyright">
      <a href="https://chinalhr.github.io/about">hanrong.li</a>
      &nbsp;&copy;
      2021
      
        &nbsp;/&nbsp;
        <a href="https://chinalhr.github.io/">ChinaLHR Blog</a>
      
      &nbsp;&ndash;&nbsp;
      <em class="fas fa-moon" id="dark-mode-toggle"></em>
    </p>

    <p class="credits theme-by">
      Powered By <a href="https://gohugo.io">Hugo</a>&nbsp;
      Theme
      <a href="https://github.com/matsuyoshi30/harbor">Harbor</a>
    </p>
  </div>
</footer>

  </body>
</html>
